---
0x00: # DEFAULT
    :properties:
      :short_name: NEW
      :long_name: Unknown
      :verbose: true
    :klass: Base

# ************************************************************************* #
#                               BMBT/MID
# ************************************************************************* #

0x21: # MID-21 / RAD-21* / TEL-21*
  :properties:
    :short_name: MID-21
    :long_name: MID Display
  :klass: Base
  :schemas:
    - :tel
    - :rad
  # SCHEMA 0x21 RAD-21*
  :rad:
    :klass: Parameterized::MID::Radio
    :properties:
      :short_name: RAD-21*
      :long_name: MID Display
    :index:
      :layout: 0
      :m2: 1
      :m3: 2
      :chars: !ruby/range
              begin: 3
              end: -1
              excl: false
    :parameters:
      :layout:
        :type: :map
        :dictionary:
          0x41: 'Presets'
          0x43: 'Source'
          0x60: 'RDS Menu A'
          0x61: 'RDS Menu B'
          0x63: 'RDS Static'
          0x83: 'Tape Side/Dolby'
          0xc0: 'CDC Discs'
      :m2:
        :meta:
          - 0x41:
            - applies to radio source
            - lowest 3 bits is the selected preset
            - presumably affects MID only
          - 0x43:
            - applies when source is Radio
            - highest 3 bits are the selected freq. band
            - likely to only affect MID
            - unsure of what effect they have?
          - 0x83:
            - tape is the only source to which Dolby B/C applies
            - presumably then, this applies to source tape
            - 'lowest 3 bits are dolby: off, B, or C'
          - 0x60:
            - value of m2 will be returned by command INPUT 0x30
            - this applies from 0x00..0xff, so no other use for byte
            - each cell can be set to an different value value
            - I believe this is the only layout in which checkbox works
          - 0x61:
            - as per 0x60, the value for an index is returned by INPUT 0x30
            - likely due to layout also being used by SOS
        :type: :bit_array
        :index:
          :band:  !ruby/range
                    begin: 0
                    end: 2
                    excl: false
          :preset:  !ruby/range
                    begin: 5
                    end: 7
                    excl: false
        :parameters:
          # Layout 0x43 (Source) only!
          :band:
            :type: :map
            :label: 'Band (0x43)'
            :map:
              0b0_00: :fm_a
              0b0_01: :fm_1
              0b0_10: :fm_2

              0b1_10: :am_a
              0b1_11: :am_1
            :dictionary:
              0b0_00: 'FMA'    # " A1‚òêA2 ‚òê A3‚òêA4 ‚òê A5‚òêA6 "
              0b0_01: 'FM1'    # " 1 ‚òê 2 ‚òê*3 ‚òê 4 ‚òê 5 ‚òê 6 "

              0b0_10: 'FM2'    # " 7 ‚òê 8 ‚òê 9 ‚òê10 ‚òê 11‚òê12 "
              0b1_10: 'AMA'    # " A1‚òêA2 ‚òê*A3‚òêA4 ‚òê A5‚òêA6 "
              0b1_11: 'AM1'    # "*1 ‚òê 2 ‚òê 3 ‚òê 4 ‚òê 5 ‚òê 6 "
          # Layout 0x41 (Preset) and 0x83 (Dolby) only!
          :preset:
            :type: :map
            :label: 'Preset (0x41), Dolby: (0x83)'
            :map:
              0b000: :none
              0b001: :p1
              0b010: :p2
              0b011: :p3
              0b100: :p4
              0b101: :p5
              0b110: :p6
              # 0x41:
              #   0b000: :none
              #   0b001: :p1
              #   0b010: :p2
              #   0b011: :p3
              #   0b100: :p4
              #   0b101: :p5
              #   0b110: :p6
              # 0x83:
              #   0b000: :dolby_off
              #   0b001: :dolby_b
              #   0b010: :dolby_c
            :dictionary:
              0b000: 'No Preset'
              0b001: 'P1'
              0b010: 'P2'
              0b011: 'P3'
              0b100: 'P4'
              0b101: 'P5'
              0b110: 'P6'
              # 0x41:
              #   0b000: 'No Preset'
              #   0b001: 'P1'
              #   0b010: 'P2'
              #   0b011: 'P3'
              #   0b100: 'P4'
              #   0b101: 'P5'
              #   0b110: 'P6'
              # :0x83:
              #   0b000: 'Dolby Off'
              #   0b001: 'Dolby B'
              #   0b010: 'Dolby C'
      :m3:
        :meta:
          - 0x60:
            - highest bit will render display with preselected cell
          - 0x61:
            - highest bit will render display with preselected cell
            - highest bit can be used to preselect one of the four buttons
            - calling 0x21 for a given button index will render it
        :type: :bit_array
        :parameters:
          :selected:
            :type: :switch
            :label: Selected
            :states:
              0: :off
              1: :on
          # no GFX-CACHE using this using MK1 GFX
          :block:
            :type: :switch
            :label: Block
            :states:
              0: :off
              1: :on
          :flush:
            :type: :switch
            :label: Flush
            :states:
              0: :off
              1: :on
          :index:
            :type: :integer
        :index:
          :selected: 0
          :block: 1
          :flush: 2
          :index:  !ruby/range
                    begin: 3
                    end: 7
                    excl: false
      :chars:
        :type: :chars
  # SCHEMA 0x21 TEL-21
  :tel:
    :klass: Parameterized::MID::Telephone
    :properties:
      :short_name: TEL-21*
      :long_name: MID Display
    :index:
      :layout: 0
      :m2: 1
      :m3: 2
      :chars: !ruby/range
              begin: 3
              end: -1
              excl: false
    :parameters:
      :layout:
        :meta:
          - I suspect 0xf0, and 0xf1 are only supported by MK3/4
          - 0xf0 and 0xf1 appear to be the basis for:
            - SMS
            - SOS/Emergency
            - Bluetooth pairing (title only)
          - so too do they appear to be used for Bluetooth pairing (header only)
        :type: :map
        :dictionary:
          0x42: 'Dial'
          0x43: 'Directory'
          0x80: 'Top 8'
          0xf0: 'SMS Index'
          0xf1: 'SMS Show'
      :m2:
        :meta:
          - 0x42:
            - the MK1/2 dial, or MK3/4 'home' telephone layout
            - I have tried setting m2 for Top 8, Recent, etc with no luck
          - 0x43 and 0x80:
            - directory and top 8 respectively
            - no luck setting m2 to change value returned by 0x30
          - 0xf0:
            - used for SMS Message index
            - value of m2 will be returned by command INPUT 0x30
            - each cell can be set to an different value value
            - does not work on back button which is always navigate (0x07)
            - it's possible to add item to top right cell via higher index
            - i've not been able to find any special control chars/icons
          - 0xf1:
            - the layout used for SMS view
            - looks to also be the SOS display
            - as per 0x60, the value for an index is returned by INPUT 0x30
            - likely due to layout also being used by SOS
            - no icons available via control characters
        :type: :integer
      :m3:
        :meta:
          - 0x42, 0x43, 0x80:
            - these appear to be backwards compatible MID layouts
            - use of index has no bearing on the BMBT
            - contacts must be delimitered in order to render multiple
          - 0xf0:
            - highest bit will render display with preselected cell
            - highest index bit will render back and top right cell
          - 0xf1:
            - highest bit can be used to preselect one of the four buttons
            - it's possible to render any combition of buttons
            - calling 0x21 at the given index will render it
            - highest index bit will render back and three buttons
        :type: :bit_array
        :index:
          :selected: 0
          :block: 1
          :flush: 2
          :index:  !ruby/range
                    begin: 3
                    end: 7
                    excl: false
        :parameters:
          :selected:
            :type: :switch
            :label: Selected
            :states:
              0: :off
              1: :on
          :block:
            :type: :switch
            :label: Block
            :states:
              0: :off
              1: :on
          :flush:
            :type: :switch
            :label: Flush
            :states:
              0: :off
              1: :on
          :index:
            :type: :integer

      :chars:
        :type: :chars

0x22: # MID-22
  :properties:
    :short_name: TXT-CACHE
    :long_name: Cached Write Count
  :klass: Parameterized::Base
  :parameters:
    :status:
      :type: :integer
  :index:
    :status: 0
  :meta:
    - when 0x21 is sent without block flag, all cached writes are rendered
    - the value returned is the number of cells written
    - i.e. 3 writes with block, 1 write without block => 3

0x23: # TXT-23 / RAD-23* / TEL-23*
  :properties:
    :short_name: TXT-23
    :long_name: Update Text Display (BMBT, IKE)
  :klass: Base
  :schemas:
    - :tel
    - :rad
  :rad: # RAD-23*
    :klass: Parameterized::Base
    :properties:
      :short_name: RAD-23
      :long_name: Update Text Display (BMBT, IKE)
    :index:
      :gfx: 0
      :ike: 1
      :chars: !ruby/range
                begin: 2
                end: -1
                excl: false
    :parameters:
      :gfx:
        :type: :map
        :dictionary:
          # Service Mode
          0x0_2: (Service) Serial Number
          0x0_3: (Service) Software Version
          0x0_4: (Service) GAL
          0x0_5: (Service) F & Q?
          0x0_6: (Service) DSP
          0x0_7: (Service) Seek Level
          0x0_8: (Service) TP Volume

          0x0_9: (Service) AF
          0x0_a: (Service) Region

          0x1_2: (Service) Serial Number
          0x1_3: (Service) Software Version
          0x1_4: (Service) GAL
          0x1_5: (Service) F & Q?
          0x1_6: (Service) DSP
          0x1_7: (Service) Seek Level
          0x1_8: (Service) TP Volume

          # Weather Band
          0x2_0: (Weather Band) No Station
          0x2_1: (Weather Band) WB CH 1
          0x2_2: (Weather Band) WB CH 2
          0x2_3: (Weather Band) WB CH 3
          0x2_4: (Weather Band) WB CH 4
          0x2_5: (Weather Band) WB CH 5
          0x2_6: (Weather Band) WB CH 6
          0x2_7: (Weather Band) WB CH 7
          0x2_8: (Weather Band) WB

          0x3_0: (Weather Band) No Station
          0x3_1: (Weather Band) WB CH 1
          0x3_2: (Weather Band) WB CH 2
          0x3_3: (Weather Band) WB CH 3
          0x3_4: (Weather Band) WB CH 4
          0x3_5: (Weather Band) WB CH 5
          0x3_6: (Weather Band) WB CH 6
          0x3_7: (Weather Band) WB CH 7
          0x3_8: (Weather Band) WB

          # Radio
          0x4_0: (Radio) Set Station
          0x4_1: (Radio) m    # Mode: Manual
          0x4_2: (Radio) SCAN # Mode: SCAN
          0x4_3: (Radio) II   # Mode: Search (Sensitive)
          0x4_4: (Radio) I    # Mode: Search (Non Sensitive)
          0x4_5: (Radio) --
          0x4_6: (Radio) T    # Traffic Reports
          0x4_7: (Radio) TP   # Traffic Program
          0x4_8: (Radio) T (upper right?)
          0x4_9: (Radio) m + T
          0x4_a: (Radio) Scan + T
          0x4_b: (Radio) II + T
          0x4_c: (Radio) I? + T
          0x4_d: (Radio) T
          0x4_e: (Radio) T + T
          0x4_f: (Radio) TP + T

          0x5_0: (Radio) Stereo
          0x5_1: (Radio) m
          0x5_2: (Radio) SCAN
          0x5_3: (Radio) II
          0x5_4: (Radio) I
          0x5_5: (Radio) --
          0x5_6: (Radio) T
          0x5_7: (Radio) TP
          0x5_8: (Radio) T (upper right)
          0x5_9: (Radio) m + T
          0x5_a: (Radio) Scan + T
          0x5_b: (Radio) II + T
          0x5_c: (Radio) I? + T
          0x5_d: (Radio) T
          0x5_e: (Radio) T + T
          0x5_f: (Radio) TP + T

          # 0x60 to 0x7F are 'nav' screens
          # so far... only 0x62 sets anything
          0x6_0: (RDS)
          0x6_1: (RDS)
          0x6_2: (RDS)

          # Tape
          0x8_0: Tape Error
          0x8_1: --
          0x8_2: Tape (1) ‚ñ∂Ô∏é
          0x8_3: Tape (1) ‚ñ∑‚ñ∑‚ñ∑
          0x8_4: Tape (1) ‚óÅ‚óÅ‚óÅ
          0x8_6: Tape (1) ‚ñ∑‚ñ∑
          0x8_7: Tape (1) ‚óÅ‚óÅ
          0x8_8: Tape Clean
          0x8_9: Tape (A) <<>>
          0x8_a: Tape (A)
          0x8_b: --
          0x8_c: --
          0x8_d: --
          0x8_e: --
          0x8_f: --

          0x9_0: Tape Error
          0x9_1: --
          0x9_2: Tape (2) ‚ñ∂Ô∏é
          0x9_3: Tape (2) ‚ñ∑‚ñ∑‚ñ∑
          0x9_4: Tape (2) ‚óÅ‚óÅ‚óÅ
          0x9_6: Tape (2) ‚ñ∑‚ñ∑
          0x9_7: Tape (2) ‚óÅ‚óÅ
          0x9_8: Tape Clean
          0x9_9: Tape (B) <<>>
          0x9_a: Tape (B)
          0x9_b: --
          0x9_c: --
          0x9_d: --
          0x9_e: --
          0x9_f: --

          # RDS: TP?
          # On a Euro car, the button you have labelled as TRAFFIC becomes
          # RDS TP (only the labelling on the button changes)
          0xa_0: (Traffic) No Station
          0xa_1: (Traffic) Traffic 1
          0xa_2: (Traffic) Traffic 2
          0xa_3: --
          0xa_4: (Traffic) No Station
          0xa_5: (Traffic) Traffic 1
          0xa_6: (Traffic) Traffic 2
          0xa_7: --
          0xa_8: (Traffic) No Station
          0xa_9: (Traffic) Traffic 1
          0xa_a: (Traffic) Traffic 2
          0xa_b: --
          0xa_c: --
          0xa_d: --
          0xa_e: --
          0xa_f: --

          0xb_0: Untested
          0xb_1: Untested
          0xb_2: Untested
          0xb_3: Untested
          0xb_4: Untested
          0xb_5: Untested
          0xb_6: Untested
          0xb_7: Untested
          0xb_8: Untested
          0xb_9: Untested
          0xb_a: Untested
          0xb_b: Untested
          0xb_c: Untested
          0xb_d: Untested
          0xb_e: Untested
          0xb_f: Untested

          # all the way through to C0, then
          # C0..DF: display text

          # E0..EF: nothing
          # 0x41: IKE Set (540)
          # 0x62: Section Update? (540)

          # To have the 'Track' layout applied, the below format must be used
          # otherwise the zone defaults to 11 characters without a layout.
          # Pattern = "CD [0-9]{1}-[a-zA-Z0-9]{2}"
          0xc_0: --
          0xc_1: (CD) No Magazine!
          0xc_2: (CD) No Disc!
          0xc_3: --
          0xc_4: (CD) [< >] Disc/Track
          0xc_5: (CD) >>
          0xc_6: (CD) <<R
          0xc_7: (CD) [SCAN]
          0xc_8: (CD) [RANDOM]
          0xc_9: --
          0xc_a: (CD) [<< >>] Fast Forward/Reverse
          0xc_b: (CD) Empty Casette Track Change?
          0xc_c: --
          0xc_d: --
          0xc_e: --
          0xc_f: --
      :ike: &ike_options
        :type: :map
        :map:
          0b0000_0000: :off
          0b0001_0000: :overwrite
          0b0010_0000: :flush
          0b0011_0000: :replace
        :dictionary:
          0b0000_0000: --
          0b0001_0000: Overwrite
          0b0010_0000: Reset
          0b0011_0000: Replace
      :chars:
        :type: :chars
  :tel: # TEL-23*
    :klass: Parameterized::Base
    :properties:
      :short_name: TEL-23*
      :long_name: Update Text Display (BMBT, IKE)
    :index:
      :gfx: 0
      :ike: 1
      :chars: !ruby/range
                begin: 2
                end: -1
                excl: false
    :parameters:
      :gfx:
        :type: :map
        :dictionary:
          # to: ANZV
          # possible backwards compatibility with MID
          0x0_1: '[ANZV] On Call [‚ñ∑ ‚óÅ]'     # [198, 199]
          0x0_2: '[ANZV] On Call HFS [üîä]'  # [197]

          # to: IKE
          # 0x40 always follows 0x43 "TEL #{number}"- presumably end call
          0x4_0: '[IKE] Clear (End Call)/Error'   # ""
          0x4_1: '[IKE] Clear (R/T Radio Mode)'   # ""
          0x4_2: '[IKE] Contact Name'             # "TEL1-MessageBank"
          0x4_3: '[IKE] Contact Number/Call'      # "TEL1-101" / "TEL    98272742"

          # to: GFX
          0x0_5: '[Pin] Number'

          0x5_2: '[Directory] Contact Name'         # "MUM"
          0x5_3: '[Directory] Contact Number/Clear' # "98272742"

          0x6_1: '[Dial/Recent] Clear'
          0x6_3: '[Dial/Recent] Number'

          0x8_0: '[Top 8] Clear'
          0x8_1: '[Top 8] Contact Name'
          0x8_2: '[Top 8] Contact Number'

          # TBC
          # This is used when there was no SIM card inserted.
          # It just had emergency button from memory
          0x0_0: '[Default] Title?'
          0x9_0: '[Info] Title?'
          # This might have been "SOS: 112!"?
          0xc_0: '[SOS] Title?'
      :ike: *ike_options
      :chars:
        :type: :chars
  :meta:
    :desc: used to updated display with media informtion upon change. Text displayed
      is based upon the media mode (radio, tape, CDC).
    :recipients:
      0xFF: GLO-H
      0x80: IKE
      0x3B: GFX
    :notes:
      - How you change the radio station affects what messages are sent
      - Changing via MFL will send to GLO-H as the message is consumed by
        multiple devices (GFX and HUD set)
      - Changing via BMBT will only send to GFX as the IKE display is not
        updated.
      - When the change is made via BMBT the message will still contain the
        sub command for the IKE but it will always be 0x20
      - The text sub command contains control characters of 0x04, 0x03 etc,
        but I'm not sure what their purpose is yet.
      - i know the GFX has multiple zones and it might denote the substrings
        intended for each screen element
    :examples:
      - MFL (Next/Previous)
      - display radio freuqnecy (with CLEAR display text being displayed)
        - RAD	GLO-H	23	40 20	07 20 2D 35 2D 20 08 46 4D 20 03 31 30 35 2E 31 04
      - update radio freuqnecy (with EXISITING text being displayed)
        - RAD	GLO-H	23	40 30	07 20 2D 35 2D 20 08 46 4D 20 03 31 30 35 2E 31 04
      - update radio frequency updaed \'ST\'
        - RAD	GLO-H	23	50 30	07 20 2D 35 2D 20 08 46 4D 20 03 31 30 35 2E 31 04 20 53 54
      - clear IKE display
      - RAD	IKE	  23	50 20

0xA5: # TXT-A5 / TEL-A5* / RAD-A5*
  :properties:
    :short_name: TXT-A5
    :long_name: Unknown
  :klass: Base
  :schemas:
    - :tel
    - :rad
  :tel: # TEL-A5*
    :properties:
      :short_name: TEL-A5*
      :long_name: Unknown
    :klass: Parameterized::Base
    :index:
      :layout: 0
      :padding: 1
      :zone: 2
      :chars: !ruby/range
                begin: 3
                end: -1
                excl: false
    :parameters:
      :layout:
        :type: :map
        :dictionary:
          0xf0: SMS Index
          0xf1: SMS Show
        :map:
          0xf0: :sms_index
          0xf1: :sms_show
      :padding:
        :type: :bit_array
        :index:
          :tbc:  !ruby/range
            begin: 0
            end: 1
            excl: false
          :padding: !ruby/range
            begin: 2
            end: 7
            excl: false
        :parameters:
          :tbc:
            :type: :data
            :label: TBC
          :padding:
            :type: :map
            :dictionary:
              0: Do nothing?
              1: No Padding
              2: Pad 1
              3: Pad 2
              4: Pad 3
              5: Pad 4
              6: Pad 5
              7: Pad 6
              8: Pad 7
              9: Pad 8
              10: Pad 9
              11: Pad 10
              12: Pad 11
              13: Pad 12
              14: Pad 13
              15: Pad 14
              16: Pad 15
              17: Pad 16
              18: Pad 17
      :zone:
        :type: :bit_array
        :index:
          :selected: 0
          :block: 1
          :flush: 2
          :zone: !ruby/range
            begin: 3
            end: 7
            excl: false
        :parameters:
          :selected:
            :type: :switch
            :label: 'Selected'
            :states:
              0: :off
              1: :on
          :block:
            :type: :switch
            :label: 'Block'
            :states:
              0: :off
              1: :on
          :flush:
            :type: :switch
            :label: 'Flush'
            :states:
              0: :off
              1: :on
          :zone:
            :type: :map
            :label: 'Zone'
            :map:
              0b000: :none

              0b001: :a
              0b010: :b
              0b011: :c
              0b100: :d
              0b101: :e

              0b110: :h2
              0b111: :h3
            :dictionary:
              0b0_0000: '0'

              0b001: 'A/1'
              0b010: 'B/2'
              0b011: 'C/3'
              0b100: 'D/4'
              0b101: 'E/5'

              0b110: 'H2/6'
              0b111: 'H3/7'
      :chars:
        :type: :chars
  :rad: # RAD-A5*
    :properties:
      :short_name: RAD-A5*
      :long_name: Unknown
    :klass: Parameterized::Base
    :index:
      :layout: 0
      :padding: 1
      :zone: 2
      :chars: !ruby/range
                begin: 3
                end: -1
                excl: false
    :parameters:
      :layout:
        :type: :map
        :dictionary:
          0x60: Menu A
          0x61: Menu B
          0x62: Header
          0x63: Static
        :map:
          0x00: :no_source
          0x60: :rds_1
          0x61: :rds_2
          0x62: :rds_title
          0x63: :rds_static
      :padding:
        :type: :map
        :dictionary:
          0: Do nothing?
          1: No Padding
          2: Pad 1
          3: Pad 2
          4: Pad 3
          5: Pad 4
          6: Pad 5
          7: Pad 6
          8: Pad 7
          9: Pad 8
          10: Pad 9
          11: Pad 10
          12: Pad 11
          13: Pad 12
          14: Pad 13
          15: Pad 14
          16: Pad 15
          17: Pad 16
          18: Pad 17
      :zone:
        :type: :bit_array
        :index:
          :default: 0
          :block: 1
          :flush: 2
          :back: 3
          :zone: !ruby/range
            begin: 5
            end: 7
            excl: false
        :parameters:
          :back:
            :type: :switch
            :label: 'Back'
            :states:
              0: :off
              1: :on
          :default:
            :type: :switch
            :label: 'Default'
            :states:
              0: :off
              1: :on
          :block:
            :type: :switch
            :label: 'Block'
            :states:
              0: :off
              1: :on
          :flush:
            :type: :switch
            :label: 'Flush'
            :states:
              0: :off
              1: :on
          :zone:
            :type: :map
            :label: 'Zone'
            :map:
              0b000: :none

              0b001: :a
              0b010: :b
              0b011: :c
              0b100: :d
              0b101: :e

              0b110: :h2
              0b111: :h3
            :dictionary:
              0b0_0000: '0'

              0b001: 'A/1'
              0b010: 'B/2'
              0b011: 'C/3'
              0b100: 'D/4'
              0b101: 'E/5'

              0b110: 'H2/6'
              0b111: 'H3/7'
      :chars:
        :type: :chars
  :meta:
    :notes:
      - 540 RAD sending this to GFX
      - command 0x23 with gfx argument of 0x60..0x7f must be used to change display layout to 'nav'
    :examples:
      - RAD GFX	TXT? 	62 01 [7, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32] ("‚òê                    ")
      - RAD GFX	TXT? 	62 01 [65, 32, 70, 77, 50, 32] ("A FM2 ")
      - RAD GFX	TXT? 	62 01 [66, 32, 80, 32, 49, 32] ("B P 1 ")
      - RAD GFX	TXT? 	62 01 [67, 32, 32, 32, 32, 32] ("C     ")
      - RAD GFX	TXT? 	62 01 [68, 32, 32, 32, 32, 32] ("D     ")
      - RAD GFX	TXT? 	62 01 [69, 32, 32, 82, 68, 83, 32, 32] ("E  RDS  ")
      - RAD GFX	TXT? 	62 01 [70, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32] ("F                    ")

0x31: # INPUT / INPUT-RAD* / INPUT-TEL*
  :schemas:
    - :tel
    - :rad
  :klass: Base
  :rad:
    :klass: Parameterized::Base
    :properties:
      :short_name: INPUT-RAD*
      :long_name: Radio Menu Soft Buttom
    :index:
      :layout: 0
      :function: 1
      :button: 2
    :parameters:
      :layout:
        :type: :map
        :dictionary:
          0x00: --
          0x60: Menu A # RDS
          0x61: Menu B # RDS
        :map:
          0x00: :no_source
          0x60: :rds_1
          0x61: :rds_2
      :function:
        :type: :map
        :dictionary:
          0x00: --
        :map:
          0x00: :no_function
      :button:
        :type: :bit_array
        :index:
          :state: !ruby/range
                          begin: 1
                          end: 2
                          excl: false
          :id: !ruby/range
                        begin: 3
                        end: 7
                        excl: false
        :parameters:
          :id:
            :type: :map
            :label: 'Index'
            :dictionary:
              0x00: '0'
              0x01: '1'
              0x02: '2'
              0x03: '3'
              0x04: '4'
              0x05: '5'
              0x06: '6'
              0x07: '7'
              0x08: '8'
              0x09: '9'
              0x0a: '10'
          :state: &button_state
            :type: :switch
            :label: 'State'
            :states:
              0b00: :press
              0b01: :hold
              0b10: :release
            :dictionary:
              0b00: Press
              0b01: Hold
              0b10: Release
  :tel:
    :klass: Parameterized::Button::Soft
    :properties:
      :short_name: INPUT-TEL*
      :long_name: Telephone Menu Soft Buttom
    :index:
      :layout: 0
      :function: 1
      :action: 2
    :parameters:
      :layout:
        :type: :map
        :dictionary:
          0x00: --
          0x05: Pin
          0x20: Info
          0x42: Dial
          0x43: Directory
          0x80: Top 8
          0xf0: SMS Index
          0xf1: SMS Show
        :map:
          0x00: :default
          0x05: :pin
          0x20: :info
          0x42: :dial
          0x43: :directory
          0x80: :top_8
          0xf0: :sms_index
          0xf1: :sms_show
      :function:
        :type: :map
        :dictionary:
          0x00: --
          0x01: Contact
          0x02: Digit
          0x05: SOS
          0x07: Navigate
          0x08: Info
        :map:
          0x00: :no_function
          0x01: :contact
          0x02: :digit
          0x05: :sos
          0x07: :navigate
          0x08: :info
      :action:
        :type: :bit_array
        :index:
          :state: !ruby/range
                          begin: 1
                          end: 2
                          excl: false
          :id: !ruby/range
                        begin: 3
                        end: 7
                        excl: false
        :parameters:
          :id:
            :type: :map
            :label: 'Index'
            :dictionary:
              0x00: 0x00
              0x01: 0x01
              0x02: 0x02
              0x03: 0x03
              0x04: 0x04
              0x05: 0x05
              0x06: 0x06
              0x07: 0x07
              0x08: 0x08
              0x09: 0x09
              0x0a: 0x0a/Info/<
              0x0b: 0x0b
              0x0c: 0x0c/Back
              0x0d: 0x0d/Forward
              0x0e: 0x0e
              0x0f: 0x0f

              0x10: 0x10/Back

              0x11: 0x11/Button Left
              0x12: 0x12/Button Right
              0x13: 0x13/Button Centre/Outlier
              0x14: 0x14
              0x15: 0x15
              0x16: 0x16

              0x1a: 26/*
              0x1b: '27/#'

              0x1d: SMS
              0x1e: Dial
              0x1f: Directory
          :state:
            *button_state
  :meta:
    :sos:
      - BMBT  	GFX   	BMBT-BTN-1	[Confirm] Press
      - Open SOS from default layout ->
      - GFX   	TEL   	TEL-DATA    00 05 08
      - 'TEL   	GFX   	TXT-MEDIA 	C0 20	"SOS: 112!"'
      - BMBT  	GFX   	BMBT-BTN-1	[Confirm] Release

# ************************************************************************* #
#                                  ANZV
# ************************************************************************* #

0x24: # ANZV-VAR / ANZV-VAR-IKE* / ANZV-VAR-TEL* / ANZV-VAR-RAD*
  :properties:
    :short_name: ANZV-VAR
    :long_name: OBC Display (IKE, GFX)
  :klass: Parameterized::Base
  :schemas:
    - :tel
    - :ike
    - :rad
  :parameters:
    :field:
      :type: :map
      :dictionary:
        0x00: --
    :ike:
      :type: :map
      :dictionary:
        0x00: --
        0x20: Set
        0x30: Update
    :chars:
      :type: :chars
  :index:
    :field: 0
    :ike: 1
    :chars: !ruby/range
              begin: 2
              end: -1
              excl: false
  # 0x24 ANZV-VAR-IKE*
  :ike:
    :klass: Parameterized::Base
    :properties:
      :short_name: ANZV-VAR-IKE*
      :long_name: OBC Display (IKE, GFX)
    :parameters:
      :field:
        :type: :map
        :dictionary:
          # SETTINGS
          0x01: (Settings) Time           # "17:27  "
          0x02: (Settings) Date           # "22.07.2019"

          # ON-BOARD COMPUTER
          0x03: (OBC) Temperature    # "+14.5"
          0x04: (OBC) Consump. 1     # "--.- L/100"
          0x05: (OBC) Consump. 2     # "--.- L/100"
          0x06: (OBC) Range          # " 59 MLS"
          0x07: (OBC) Distance       # "   5 MLS"
          0x08: (OBC) Arrival        # "17:39  "
          0x09: (OBC) Limit          # "--- MPH "
          0x0a: (OBC) Avg. Speed     # "--.- MPH "
          0x0e: (OBC) Timer          # "13.0  SEC "
          0x1a: (OBC) Timer (Lap)    # " 6.2  SEC "

          # AUX. HEAT/VENTILATION
          0x0f: (Heat/Vent) Aux. Timer 1
          0x10: (Heat/Vent) Aux. Timer 2

          # CODE
          # Wait X minutes.
          0x16: '(Code) Emergency Disarm'
      :ike:
        :type: :map
        :dictionary:
          0x00: --
          0x20: Set
          0x30: Update
      :chars:
        :type: :chars
    :index:
      :field: 0
      :ike: 1
      :chars: !ruby/range
                begin: 2
                end: -1
                excl: false
  # 0x24 ANZV-VAR-RAD*
  :rad:
    :klass: Parameterized::Base
    :properties:
      :short_name: ANZV-VAR-RAD*
      :long_name: OBC Display (IKE, GFX)
    :parameters:
      :field:
        :type: :map
        :dictionary:
          0x40: Radio HUD
      :ike:
        :type: :map
        :dictionary:
          0x00: --
          0x20: Set
          0x30: Update
      :chars:
        :type: :chars
    :index:
      :field: 0
      :ike: 1
      :chars: !ruby/range
                begin: 2
                end: -1
                excl: false
  # 0x24 ANZV-VAR-TEL*
  :tel:
    :klass: Parameterized::Base
    :properties:
      :short_name: ANZV-VAR-TEL*
      :long_name: Update Info
    :index:
      :field: 0
      :ike: 1
      :chars: !ruby/range
                begin: 2
                end: -1
                excl: false
    :parameters:
      :field:
        :type: :map
        :dictionary:
          0x80: (Incoming) Header 0x80
          0x81: (Incoming) Header 0x81
          0x82: (Incoming) Header 0x82
          0x91: (Info) Signal Strength
          0x93: (Info) Call cost current
          0x94: (Info) Call cost total
          0x96: (Info) Call Time minutes
          0x97: (Info) Call time seconds
      :ike:
        :type: :map
        :dictionary:
          0x00: --
      :chars:
        :type: :chars
        # 0xB2 = 7 bars
        # 0xB3 = 6 bars
        # 0xB4 = 5 bars
        # 0xB5 = 4 bars
        # 0xB6 = 3 bars
        # 0xB7 = 2 bars
        # 0x5F = 1 bar
        # 0xB8 = 0 bars
  :meta:
      :rad:
        - RAD GLO-H TXT-1 Radio HUD "102.1   "
        - this is when it's rapidly scrolling...
          is the reduced chat array length because it's sneding so fast?
          reduced traffic or because it's a partial update to the display?

0x2A: # ANZV-BOOL / ANZV-IKE (IKE)
  :klass: Parameterized::Base
  :properties:
    :short_name: ANZV-BOOL-IKE
    :long_name: IKE to ANZV OBC Display
  :index:
    :control_a: 0
    :control_b: 1
  :parameters:
    :control_a:
      :type: :bit_array
      :index:
        :memo:  2
        :timer: 4
        :limit: 6
      :parameters:
        :memo:
          :type: :switch
          :label: '(Settings) Memo'
          :states:
            0b00: :inactive
            0b01: :on
            0b10: :on
            0b11: :on
        :timer:
          :type: :switch
          :label: '(OBC) Timer'
          :states:
            0: :inactive
            1: :on
        :limit:
          :type: :switch
          :label: '(OBC) Limit'
          :states:
            0b0: :inactive
            0b1: :on
    :control_b:
      :type: :bit_array
      :index:
        :code:            1
        # just confirm that this is direct mode...
        :aux_heating:     2
        :aux_timer_2:     3
        # just confirm that this is direct mode...
        :aux_ventilation: 4
        :aux_timer_1:     5
      :parameters:
        :code:
          :type: :switch
          :label: '[Code] Lock'
          :states:
            0: :inactive
            1: :on
          :meta:
            - the dialogue displayed when Code feature has been set.
            - it cannot be overwritten or dismissed by the user.
            - the emergency disarm variant is set via 0x24.
        :aux_heating:
          :type: :switch
          :label: '(Aux) Heating'
          :states:
            0: :inactive
            1: :on
        :aux_timer_2:
          :type: :switch
          :label: '(Aux) Timer 2'
          :states:
            0: :inactive
            1: :on
        :aux_ventilation:
          :type: :switch
          :label: '(Aux) Ventilation'
          :states:
            0: :inactive
            1: :on
        :aux_timer_1:
          :type: :switch
          :label: '(Aux) Timer 1'
          :states:
            0: :inactive
            1: :on
  :meta:
    :senders:
      - IKE
    :recipients:
      - ANZV
    :length:
      - always 2 bytes

0x2B: # ANZV-BOOL-TEL (TEL-LED)
  :properties:
    :short_name: ANZV-LED-TEL
    :long_name: Telephone LEDs on BMBT
  :klass: Parameterized::Base
  :index:
    :leds: 0
  :parameters:
    :leds:
      :type: :bit_array
      :index:
        :red: 7
        :red_blink: 6
        :yellow: 5
        :yellow_blink: 4
        :green: 3
        :green_blink: 2
      :parameters:
        :red:
          :label: Red
          :type: :switch
          :states:
            0: :off
            1: :on
        :red_blink:
          :label: Red Blink
          :type: :switch
          :states:
            0: :off
            1: :on
        :yellow:
          :label: Yellow
          :type: :switch
          :states:
            0: :off
            1: :on
        :yellow_blink:
          :label: Yellow Blink
          :type: :switch
          :states:
            0: :off
            1: :on
        :green:
          :label: Green
          :type: :switch
          :states:
            0: :off
            1: :on
        :green_blink:
          :label: Green Blink
          :type: :switch
          :states:
            0: :off
            1: :on
  :meta:
    :senders:
      - TEL
    :recipients:
      - ANZV

0x2C: # ANZV-BOOL-TEL (TEL-STATUS)
  :properties:
    :short_name: ANZV-BOOL-TEL
    :long_name: Unknown
  :parameters:
    :status:
      :type: :bit_array
      :index:
        #          0
        #          1
        :active:   2
        :power:    3

        :display:  4
        :incoming: 5
        :menu:     6
        :hfs:      7
      :parameters:
        :active:
          :label: In Use
          :type: :switch
          :states:
            0: :off
            1: :on
        :power:
          :label: Power
          :type: :switch
          :states:
            0: :off
            1: :on
        :display:
          :label: Display?
          :type: :switch
          :states:
            0: :off
            1: :on
        :incoming:
          :label: Incoming Call
          :type: :switch
          :states:
            0: :off
            1: :on
        :menu:
          :label: Menu?
          :type: :switch
          :states:
            0: :off
            1: :on
        :hfs:
          :label: Handsfree
          :type: :switch
          :states:
            0: :off
            1: :on
  :index:
    :status: 0
  :klass: Parameterized::Base
  :meta:
    :status:
      - 0: messages?
      - 1: messages?
      - active: changes phone icon to green/red
      - power: '?'
      - display: '?'
      - incoming: monitor view
      - menu: menu is open on BMBT?
      - hfs: hide/show speaker icon
    :senders:
      - TEL
    :recipients:
      - ANZV

# ************************************************************************* #
#                                 NAVIGATION
# ************************************************************************* #

0x1F: # NAV-IKE-TIME
  :properties:
    :short_name: NAV-IKE-TIME
    :long_name: UTC time and date
  :klass: Parameterized::GPS::Time
  :index:
    :tz: 0
    :hour: 1
    :minute: 2
    :day: 3
    :second: 4
    :month: 5
    :year:  !ruby/range
              begin: 6
              end: 7
  :parameters:
    :tz:
      :type: :data
    :hour:
      :type: :data
    :minute:
      :type: :data
    :day:
      :type: :data
    :second:
      :type: :data
    :month:
      :type: :data
    :year:
      :type: :data

# TELEMATICS

0xA2: # NAV-TEL-COORD
  :properties:
    :short_name: NAV-TEL-COORD
    :long_name: GPS Coordinates
  :klass: Parameterized::GPS::Coordinates
  # :klass: Base
  :index:
    # Signal
    :signal: 0
    # Latitude
    :lat_d: !ruby/range
              begin: 1
              end: 2
    :lat_m: 3
    :lat_s: 4
    :lat_sf: 5
    # Longitude
    :long_d: !ruby/range
              begin: 6
              end: 7
    :long_m: 8
    :long_s: 9
    :long_sf: 10
    # Vertical
    :vertical: 12
    # Time
    :hour: 14
    :minute: 15
    :second: 16
  :parameters:
    :signal:
      :type: :map
      :map:
        0x00: :disconnected
        0x01: :connected
      :dictionary:
        0x00: 'No Signal'
        0x01: 'Signal'
    :lat_d:
      :type: :data
    :lat_m:
      :type: :data
    :lat_s:
      :type: :data
    :lat_sf:
      :type: :data
    :long_d:
      :type: :data
    :long_m:
      :type: :data
    :long_s:
      :type: :data
    :long_sf:
      :type: :data
    :vertical:
      :type: :data
    :hour:
      :type: :data
    :minute:
      :type: :data
    :second:
      :type: :data
  :schemas:
    - :dia
  :dia:
    :klass: Base
    :properties:
      :short_name: EWS-END
      :long_name: Diagnostics Control

0xA4: # NAV-TEL-ADDR
  :properties:
    :short_name: NAV-TEL-ADDR
    :long_name: Unknown
  :klass: Parameterized::Base
  :index:
    :a:   0
    :b:   1
    :chars:   !ruby/range
              begin: 2
              end: -1
  :parameters:
    :a:
      :type: :map
      :dictionary:
        0x00: --
        0x01: City
        0x02: Street
    :b:
      :type: :map
      :dictionary:
        0x00: --
        0x01: City
        0x02: Street
    :chars:
      :type: :chars

0xA7: # NAV-RAD-A7
  :properties:
    :short_name: NAV-RAD-A7
    :long_name: Unknown
  :klass: Base
  :meta:
    - seemingly always..
    - 7F 04 68 A7 10 A4
    - 7F 04 68 A7 30 84
    - 7F 05 68 A7 1F 00 AA
    - 7F 05 68 A7 3F 00 8A

0xA9: # NAV-TEL-A9
  :properties:
    :short_name: NAV-TEL-A9
    :long_name: Unknown
  :klass: Base

0xAB: # NAV-GFX-AB
  :properties:
    :short_name: NAV-GFX-AB
    :long_name: Unknown
  :klass: Base

0xAF: # NAV-SES?
  :properties:
    :short_name: NAV-SES?
    :long_name: Unknown
  :klass: Base

# ************************************************************************* #
#                             BUS DEVICE STATUS
# ************************************************************************* #

0x01: # PING
  :properties:
    :short_name: PING
    :long_name: Status Request
    :verbose: false
  :klass: Base

0x02: # PONG
  :properties:
    :short_name: PONG
    :long_name: Status Response
    :status_map:
      0x00: 'Reply'
      0x01: 'Announce'
      0x30: 'External Offline Respond'
      0x31: 'External Offline Reset'
      0x40: 'Alt. Reply'
      0x41: 'Alt. Announce'
  :klass: Parameterized::Base
  :parameters:
    :status:
      :type: :map
      :dictionary:
        0x00: 'Reply'
        0x01: 'Announce'
        0x30: 'External Offline Respond'
        0x31: 'External Offline Reset'
        0x40: 'Alt. Reply'
        0x41: 'Alt. Announce'
  :index:
    :status: 0
  :meta:
    # - 0x41 will cause IGN reply
    :desc: ''
    :recipients:
      0xFF: GLO-H
      0xBF: GLO-L
    :audience:
      0x80: IKE
      0x3B: GFX
    :notes:
      - after reset (KL15) devices will announce (0x01):
        - 13:53:15 [INFO ] RAD	GLO-H	PONG	Announce
        - 13:53:16 [INFO ] TEL	GLO-H	PONG	Announce
        - 13:53:16 [INFO ] BMBT	GLO-L	PONG	Announce
      - PONG is always broadcast, not addressed to a single module:
        - "`MessageHandler.i.command(2).recipients => [FF, BF]`"
        - 13:53:25 [INFO ] BMBT	RAD      PING	--
        - 13:53:25 [INFO ] RAD	GLO-H	   PONG	Respond
        - 14:01:06 [INFO ] GFX	IKE      PING	--
        - 14:01:06 [INFO ] IKE	GLO-L    PONG	Respond
      - RAD looks for accessories:
        - 13:53:17 [INFO ] RAD	DSP	PING	--
      - BMBT looks for accessories (note ACK to GLO-H):
        - 13:53:25 [INFO ] BMBT	RAD	  PING	--
        - 13:53:25 [INFO ] RAD	GLO-H	PONG	Respond
      - BMBT will continue to PING all devices every 10 seconds:
      - GFX only awake on KL15 (makes sense given screen is off at KLR)
      - GFX looks for IKE?:
        - 14:01:06 [INFO ] GFX	IKE	PING	--
      - GFX looks for accessories (akin to RAD):
        - DSP:
          - 14:01:06 [INFO ] GFX	DSP	PING	--
        - TEL:
          - 14:01:06 [INFO ] GFX	TEL	PING	--
          - 14:01:06 [INFO ] TEL	GLO-H	PONG	Respond
      - Retry for no PONG:
        - 14:01:06 [INFO ] GFX	DSP	PING	--
        - 14:01:17 [INFO ] GFX	DSP	PING	--
      - KBUS:
        - PDC announces on KL30:
          - 14:01:07 [INFO ] PDC	GLO-L	PONG	Announce
        - GM doesn't seem to respond to a PING? (KL15):
          - 13:56:36 [INFO ] GM3	GLO-L	PONG	Respond
          - 14:00:04 [INFO ] GM3	GLO-L	PONG	Respond
      - '0x40 and 0x41':
        - GFX is the only device to use these variants
        - it's always sent to GLO-L
        - the lowest bit useage is consistent with 0x00/0x01:
          - KL30:
            - GM3   GLO-L PONG 00 (KBUS)
            - BMBT  GLO-L PONG 01 (reset)
            - TV    GLO-H PONG 01 (reset)
            - GFX   GLO-L PONG 41 (reset)
            - RAD   GLO-H PONG 01 (reset)
            - TEL   GLO-H PONG 01 (reset)
            - BMBT  GLO-L PONG 01 (reset)
            - CCM   GLO-L PONG 00
            - GFX   GLO-L PONG 40
            - IKE   GLO-L PONG 00
            - TEL   GLO-H PONG 00
            - PDC   GLO-L PONG 01 (KBUS)
            - RAD   GLO-H PONG 00
          - 'Normal operation':
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - GM3 GLO-L PONG 00,
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - RAD GLO-H PONG 00,
            - GFX GLO-L PONG 40,
    :examples:
      - BMBT  RAD	  PING	--
      - RAD	  GLO-H	PONG	Respond

# ************************************************************************* #
#                               IGNITION
# ************************************************************************* #

0x10: # IGN-REQ
  :properties:
    :short_name: IGN-REQ
    :long_name: Ignition Status Request
  :klass: Base

0x11: # IGN
  :properties:
    :short_name: IGN
    :long_name: Ignition Status Response
  :klass: Parameterized::Base
  :parameters:
    :position:
      :type: :bit_array
      :parameters:
        :klr:
          :label: KL-R (Pos. I)
          :type: :switch
          :states:
            0: :unpowered
            1: :powered
        :kl15:
          :label: KL-15 (Pos. II)
          :type: :switch
          :states:
            0: :unpowered
            1: :powered
        :kl50:
          :label: KL-50 (Start)
          :type: :switch
          :states:
            0: :unpowered
            1: :powered
      :index:
        :kl50: 5
        :kl15: 6
        :klr: 7
  :index:
    :position: 0
  :meta:
    :ignition:
      # KL 0 = OFF (ignition off position)
      # KL R = ignition position 1 ("run" - some electonics & modules are powered up)
      # KL 15 = ignition position 2 ("accessory" - all electronics & modules re powered)
      # KL 50 = ignition start position
      # KL 30 = ignition position 3 (where the ignition defauts after starting the engine)
      0b0: Off (Position I)
      0b1: KLR
      0b11: KL15 (Position II)
      0b111: KL50
  :meta:
    :senders:
      - IKE
    :examples:
      - 0b00000000
      - 0b00000011
      - 0b00000111

0x12: # SEN-REQ
  :properties:
    :short_name: SEN-REQ
    :long_name: IKE Sensor Status REQ
  :klass: Base
  :meta:
    :senders:
      - CCM
    :recipients:
      - IKE

0x13: # SEN
  :properties:
    :short_name: SEN
    :long_name: IKE Sensors
  :klass: Parameterized::Base
  :parameters:
    :s1:
      :type: :bit_array
      :parameters:
        :transmission:
          :type: :switch
          :label: 'Transmission Program'
          :states:
            0: :ok
            1: :fault
        :brakes:
          :type: :switch
          :label: 'Brake Pads'
          :states:
            0: :ok
            1: :fault
        :oil:
          :type: :switch
          :label: 'Oil Pressure'
          :states:
            0: :ok
            1: :fault
        :handbrake:
          :type: :switch
          :label: 'Handbrake'
          :states:
            0: :off
            1: :on
      :index:
        :transmission: 3
        :brakes: 5
        :oil: 6
        :handbrake: 7
    :s2:
      :type: :bit_array
      :parameters:
        :gear:
          :type: :map
          :label: Selected Gear
          :map:
            0b0000: :gear_na
            0b1011: :gear_p
            0b0001: :gear_r
            0b0111: :gear_n
            0b1000: :gear_d
            0b0010: :gear_1
            0b0110: :gear_2
            0b1101: :gear_3
            0b1100: :gear_4
            0b1110: :gear_5
          :dictionary:
            0b0000: No Gear
            0b1011: Park
            0b0001: Reverse
            0b0111: Neutral
            0b1000: Drive
            0b0010: First
            0b0110: Second
            0b1101: Third
            0b1100: Fourth
            0b1110: Fifth
        :door:
          :type: :switch
          :label: 'Door Open'
          :states:
            0: :ok
            1: :fault
        :ignition:
          :type: :switch
          :label: 'Ignition'
          :states:
            0: :off
            1: :on
      :index:
        :gear: !ruby/range
                  begin: 0
                  end: 3
                  excl: false
        :door: 6
        :ignition: 7
    :s3:
      :type: :integer
  :index:
    :s1: 0
    :s2: 1
    :s3: 2
  :meta:
    :notes:
      - the IKE has a number of various inputs (via analogue signals, or CAN
        depending on model year).
      - the sensor status is reported via IBUS for the use by the CCM
      - warnings:
        - parking brake
        - fasten seat belt
        - engine oil level
        - engine oil pressure
        - low coolant level
        - low washer fluid
        - brake pads
        - brake fluid
        - remote key battery voltage
      - other warnings are determined with data from other IBUS messages
      - warnings:
        - key in ignition
        - lights on
        - door open
        - trunk open
      - noted on comm.se:
        - handbrake on
        - oil pressure low
        - brake pads worn
        - transmission emergency program gearbox not in P
        - motor running
        - vehicle driving
        - reverse not plausible
        - Gear R
        - Gear 1
        - Gear 2
        - Gear D
        - alarm horn on
        - immobiliser on
        - Aux heating on
        - Aux ventillation on
        - Temp deg F
    :senders:
      - IKE
    :recipients:
      - GLO-L
    :usage:
      :byte1:
        # - 0x00: 1215
        - 0x01: 157
        - 0x02: 56
        - 0x03: 65
      :byte2:
        # - 0x00: 127
        - 0x11: 152
        - 0x13: 10
        - 0x21: 53
        - 0x23: 94

        - 0x41: 44
        - 0x43: 147

        - 0x71: 77

        - 0x81: 275
        - 0x83: 208

        - 0xB0: 89
        - 0xB1: 141

        - 0xC3: 4

        - 0xD1: 7
        - 0xD3: 65
      :byte3:
        # - 0x00: 1493

0x14: # CNTRY-REQ
  :properties:
    :short_name: CNTRY-REQ
    :long_name: Country Coding Status Request
  :klass: Base

0x15: # CNTRY
  :properties:
    :short_name: CNTRY
    :long_name: Country Coding Status Response
  :klass: Parameterized::Base
  :parameters:
    :language:
      :type: :map
      :dictionary:
        0: 'D'
        1: 'GB'
        3: 'I'
    :b2:
      :type: :bit_array
      :parameters:
        :time_format:
          :label: Time Format.
          :type: :map
          :dictionary:
            0: (24h)
            1: (12h)
        :temp_format:
          :label: Temp Format.
          :type: :map
          :dictionary:
            0: '(C.)'
            1: '(F.)'
        :date_format:
          :label: Date Format.
          :type: :map
          :dictionary:
            0: (dd.mm)
            1: (mm/dd)
      :index:
        :time_format: 0
        :temp_format: 6
        :date_format: 7
    :b3:
      :type: :bit_array
      :parameters:
        :conflict:
          :label: NFI!
          :type: :map
          :dictionary:
            0b00: '?'
            0b01: '?'
            0b10: '?'
            0b11: 'Time/Date Incompatible?'
        :distance:
          :label: Distance
          :type: :map
          :dictionary:
            0: (km)
            1: (miles)
        :consumption:
          :label: Consumption
          :type: :map
          :dictionary:
            0b000: (l/100km)
            0b101: (mpg)
            0b111: (km/l)
      :index:
        :conflict: !ruby/range
                begin: 1
                end: 2
                excl: false
        :distance: 3
        :consumption: !ruby/range
                begin: 5
                end: 7
                excl: false
    :b4:
      :type: :integer
  :index:
    :language: 0
    :b2: 1
    :b3: 2
    :b4: 3

0x16: # ODO-REQ
  :properties:
    :short_name: ODO-REQ
    :long_name: Odometer Request
  :klass: Base
  :meta:
    - from EWS 0x44
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1
    - 44 03 80 16 D1

0x17: # ODO
  :properties:
    :short_name: ODO
    :long_name: Odometer Response
  :klass: Base
  :meta:
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14
    - 80 06 BF 17 8E B7 03 14

0x18: # SPD
  :properties:
    :short_name: SPD
    :long_name: Speed & RPM
  :parameters:
    :speed:
      :type: :data
      :multiplier: 2
      :label: Speed
      :suffix: 'kmph'
    :rpm:
      :type: :data
      :multiplier: 100
      :label: RPM
      :suffix: 'rpm'
  :index:
    :speed: 0
    :rpm: 1
  :klass: Parameterized::Base
  :meta:
    :senders:
      - IKE
    :recipients:
      - GLO-L (0xBF)

0x19: # TEMP
  :schemas:
    - :ihka
    - :lcm
  :properties:
    :short_name: TEMP
    :long_name: Temperature
  :klass: Parameterized::Base
  :index:
    :ambient: 0
    :coolant: 1
    :unknown: 2
  :parameters:
    :ambient:
      :type: :data
      :label: Ambient
      :suffix: '¬∞C'
    :coolant:
      :type: :data
      :label: Coolant
      :suffix: '¬∞C'
    :unknown:
      :type: :data
      :label: Unknown
  :lcm:
    :properties:
      :short_name: TEMP-LCM*
      :long_name: Temperature
    :klass: Parameterized::Base
    :index:
      :ambient: 0
      :coolant: 1
      :unknown: 2
    :parameters:
      :ambient:
        :type: :data
        :label: Ambient
        :suffix: '¬∞C'
      :coolant:
        :type: :data
        :label: Coolant
        :suffix: '¬∞C'
      :unknown:
        :type: :data
        :label: Unknown
  :ihka:
    :properties:
      :short_name: TEMP-IHKA*
      :long_name: Temperature
    :klass: Parameterized::Base
    :index:
      :ambient: 0
      :coolant: 1
      :unknown: 2
    :parameters:
      :ambient:
        :type: :data
        :label: Ambient
        :suffix: '¬∞C'
      :coolant:
        :type: :data
        :label: Coolant
        :suffix: '¬∞C'
      :unknown:
        :type: :data
        :label: Unknown
  :meta:
    :senders:
      - IKE
    :recipients:
      - GLO-L

0x1D: # TEMP-REQ
  :properties:
    :short_name: TEMP-REQ
    :long_name: Temperature Request
  :klass: Base
  :meta:
    - from IHKA
    - 5B 03 80 1D C5
    - 5B 03 80 1D C5
    - 5B 03 80 1D C5
    - 5B 03 80 1D C5
    - 5B 03 80 1D C5
    - from LCM
    - D0 03 80 1D 4E
    - D0 03 80 1D 4E

0x53: # VEH-LCM-REQ
  :properties:
    :short_name: VEH-LCM-REQ
    :long_name: Request LCM Redundant Data Storage
  :klass: Base

0x54: # VEH-LCM
  :schemas:
    - :dia
  :properties:
    :short_name: VEH-LCM
    :long_name: Redundant Total Ddometer Mileage/Service Interval
  :klass: Parameterized::Base
  :parameters:
    :vin:
      :type: :chars
    :mileage:
      :label: Mileage Indicator (km)
      :type: :data
      :multiplier: 1000
    :fuel:
      :label: Consumed Fuel Quantity (litre)
      :type: :data
      :multiplier: 10
    :time:
      :label: Time Inspection Counter (days)
      :type: :data
  :index:
      :vin: !ruby/range
              begin: 0
              end: 4
              excl: false
      :mileage: !ruby/range
                  begin: 5
                  end: 6
                  excl: false
      :fuel: 8
      :time: !ruby/range
                  begin: 11
                  end: 12
                  excl: false
  :dia:
    :klass: Parameterized::Base
    :properties:
      :short_name: VEH*
      :long_name: Diagnostics Control
    :parameters:
      :b1:
        :type: :map
        :dictionary:
          0x05: Seat Memory
      :b2:
        :type: :map
        :dictionary:
          0x04: Angle Up
          0x05: Angle Down
      :b3:
        :label: Unknown
        :type: :integer
    :index:
      :b1: 0
      :b2: 1
      :b3: 2
  :examples:
    - "IKE   	LCM   	53        --"
    - "LCM   	IKE   	54        42 5A 00 90 10 09 83 40 40 00 00 02 64"

0x55: # VEH-IKE
  :properties:
    :short_name: VEH-IKE
    :long_name: Total Ddometer Mileage/Service Interval
  :klass: Parameterized::Base
  :index:
    :mileage: !ruby/range
                begin: 0
                end: 1
                excl: false
    :fuel: 3
    :time: !ruby/range
                begin: 6
                end: 7
                excl: false
  :parameters:
    :mileage:
      :label: Mileage Indicator (km)
      :type: :data
      :multiplier: 1000
    :fuel:
      :label: Consumed Fuel Quantity (litre)
      :type: :data
      :multiplier: 10
    :time:
      :label: Time Inspection Counter (days)
      :type: :data

0x59: # RLS-LUM
  :properties:
    :short_name: RLS-LUM
    :long_name: Luminosity Reading?
  :klass: Parameterized::Base
  :parameters:
    :lum:
      :type: :integer
    :tbc:
      :type: :integer
  :index:
    :lum: 0
    :tbc: 1

0x5A: # LAMP-REQ
  :properties:
    :short_name: LAMP-REQ
    :long_name: Lamp Status Request
  :klass: Base

0x5B: # LAMP
  :properties:
    :short_name: LAMP
    :long_name: Lamp Status
  :klass: Parameterized::Base
  :index:
    :l1: 0
    :l2: 1
    :l3: 2
    :l4: 3
  :parameters:
    :l1:
      :type: :bit_array
      :index:
        :rapid: 0
        :indicate_right: 1
        :indicate_left: 2
        :fog_rear: 3
        :fog_front: 4
        :beam_high: 5
        :beam_low: 6
        :parking: 7
      :parameters:
        :rapid:
          :label: Rapid.
          :type: :switch
          :states:
            0: :off
            1: :on
        :indicate_right:
          :label: Indicate Right
          :type: :switch
          :states:
            0: :off
            1: :on
        :indicate_left:
          :label: Indicate Left
          :type: :switch
          :states:
            0: :off
            1: :on
        :fog_rear:
          :label: Fog Rear
          :type: :switch
          :states:
            0: :off
            1: :on
        :fog_front:
          :label: Fog Front
          :type: :switch
          :states:
            0: :off
            1: :on
        :beam_high:
          :label: High Beam
          :type: :switch
          :states:
            0: :off
            1: :on
        :beam_low:
          :label: Low Beam (Dipped)
          :type: :switch
          :states:
            0: :off
            1: :on
        :parking:
          :label: Parking Lights
          :type: :switch
          :states:
            0: :off
            1: :on
    :l2:
      :type: :bit_array
      :index:
        :indicate_right: 1
        :indicate_left: 2
      :parameters:
        :indicate_right:
          :type: :switch
          :label: Globe Indicator Right
          :states:
            0: :ok
            1: :fault
        :indicate_left:
          :type: :switch
          :label: Globe Indicator Left
          :states:
            0: :ok
            1: :fault
    :l3:
      :type: :bit_array
      :index:
        :hazard: 5
        :brake: 6
      :parameters:
        :hazard:
          :type: :switch
          :label: Indicator/Hazard
          :states:
            0: :off
            1: :on
        :brake:
          :type: :switch
          :label: Globe Brake
          :states:
            0: :ok
            1: :fault
    :l4:
      :type: :bit_array
      :index:
        :fog_rear: 1
        :brake_left: 6
        :brake_right: 7
      :parameters:
        :fog_rear:
          :type: :switch
          :label: Fog Rear
          :states:
            0: :off
            1: :on
        :brake_left:
          :type: :switch
          :label: Globe Brake Left?
          :states:
            0: :off
            1: :fault
        :brake_right:
          :type: :switch
          :label: Globe Brake Right?
          :states:
            0: :off
            1: :fault

  :meta:
    :notes:
      - lamp drives the night mode on BMBT
      - i think it also drivces the IKE as the signals trigger the indicators but the lamps don't actually fire
      - but i can't get the CCM to fire warning
      - byte2:
        1: right indicator globe out
        2: left indicator globe out
      - byte3:
        5: indicating/hazards
        6: brake light out, i think this drives CCM
      - byte4:
        1: rear fog switched on (stays on regardless of lights)
        6: left break globe out (not hatch)
        7: right break globe out (not hatch)

0x5C: # 58G
  :properties:
    :short_name: '58G'
    :long_name: Instrument Lighting
  :klass: Parameterized::Base
  :index:
    :light: 0
  :parameters:
    :light:
      :type: :integer
  :meta:
    :notes:
      - to date it alternates between two values 0xED and 0xFF
      - it is triggered by the external lights being switched on
      - 0xFF is off
      - 0xED seems to be highest 'on' value
    :senders:
      - LCM
    :recipients:
      - GLO-L

0x5D: # 58G-REQ
  :properties:
    :short_name: '58G-REQ'
    :long_name: Instrument Lighting
  :klass: Base
  :meta:
    :notes:
      - always from IKE 0x80 to LCM 0xD0
      - seems to preceed 0x5C
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9
      - IKE 03 LCM  5D 0E
      - LCM 05 BF   5C FF 00 C9

0x72: # REMOTE
  :properties:
    :short_name: REMOTE
    :long_name: Remote Central Locking
  :klass: Parameterized::Base
  :parameters:
    :b1:
      :type: :bit_array
      :parameters:
        :boot:
          :type: :switch
          :label: Boot Unlock
          :states:
            0: :off
            1: :on
        :unlock:
          :type: :switch
          :label: Remote Unlock
          :states:
            0: :off
            1: :on
        :lock:
          :type: :switch
          :label: Remote Lock
          :states:
            0: :off
            1: :on
        :coding1:
          :type: :switch
          :label: Two-Stage Unlock?
          :states:
            0: :off
            1: :ok
        :coding2:
          :type: :switch
          :label: Two-Stage Unlock?
          :states:
            0: :off
            1: :ok
      :index:
        :boot: 1
        :unlock: 2
        :lock: 3
        :coding1: 5
        :coding2: 6
  :index:
    :b1: 0

0x73: # KEY-REQ
  :properties:
    :short_name: KEY-REQ
    :long_name: Key Status Request
  :klass: Base

0x74: # KEY
  :properties:
    :short_name: KEY
    :long_name: Key Status
  :klass: Command::Parameterized
  :parameters:
    :status:
      :type: :map
      :map:
        0x00: unrecognised
        0x01: unauthenticated
        0x04: valid
        0x05: authenticated
      :dictionary:
        0x00: No Longer Recognised
        0x04: Valid and/or Enabled
        0x01: Unauthenticated (Immobilizer Renabled)
        0x05: Authenticated (Immobilizer Disabled)
        0x0C: When old key was unhappy in INPA
        0x08: When old key was unhappy in INPA
    :key:
      :type: :map
      :map:
        0x00: :key_1
        0x01: :key_2
        0x02: :key_3
        0x03: :key_4
        0x04: :key_5
        0xFF: :no_key
      :dictionary:
        0x00: Key 1
        0x01: Key 2
        0x02: Key 3
        0x03: Key 4
        0x04: Key 5
        0xFF: No Key
  :index:
    :status: 0
    :key: 1
  :klass: Parameterized::Base
  :meta:
    :senders:
      - EWS
    :notes:
      - invalid reasons:
        - changing code
        - identification
        - password
        - disabled

0x76: # REMOTE2
  :properties:
    :short_name: REMOTE2
    :long_name: Unknown
  :klass: Base
  :meta:
    - send following keyless entry/lock
    - gm	glo_l	76 02
    - gm	glo_l	76 00
    - I believe GM is too old for car/key memory

0x78: # MEM-LOAD
  :properties:
    :short_name: MEM-LOAD
    :long_name: Control unit, seat/steering column memory
  :klass: Parameterized::Base
  :index:
    :status: 0
  :parameters:
    :status:
      :type: :bit_array
      :index:
        :save: 4
        :preset: !ruby/range
                begin: 5
                end: 7
                excl: false
      :parameters:
        :save:
          :type: :switch
          :label: Save
          :states:
            0: :off
            1: :on
        :preset:
          :type: :map
          :label: Preset
          :map:
            0b000: :preset_nil
            0b001: :preset_1
            0b010: :preset_2
            0b100: :preset_3
          :dictionary:
            0b000: --
            0b001: '1'
            0b010: '2'
            0b100: '3'
  :meta:
    :notes:
      - 504 messages sent to date
      - GM3   	GLO-L 	78       	00
      - GM3   	GLO-L 	78       	00
      - GM3   	GLO-L 	78       	00
      - GM3   	GLO-L 	78       	00
      - GM3   	GLO-L 	78       	01
      - GM3   	GLO-L 	78       	02
      - GM3   	GLO-L 	78       	04
      - GM3   	GLO-L 	78       	04
      - this was being sent after DIA request memory preset
      - argument seemingly correlated with preset number/ID

0x79: # DOOR-REQ
  :properties:
    :short_name: DOOR-REQ
    :long_name: Door/Flag Request Status
  :klass: Base

0x7A: # DOOR
  :properties:
    :short_name: DOOR
    :long_name: Door/Flap Status
  :klass: Parameterized::Base
  :parameters:
    :byte1:
      :type: :bit_array
      :parameters:
        :lamp_interior:
          :type: :switch
          :label: 'Interior Lights'
          :states:
            0: :off
            1: :on
        :locked:
          :type: :switch
          :label: 'Central Lock.'
          :states:
            0: :off
            1: :on
        :hood:
          :type: :switch
          :label: 'Hood?'
          :states:
            0: :closed
            1: :open
        :door_left:
          :type: :switch
          :label: 'Door Rear Left'
          :states:
            0: :closed
            1: :open
        :door_right:
          :type: :switch
          :label: 'Door Rear Right'
          :states:
            0: :closed
            1: :open
        :door_pass:
            :type: :switch
            :label: 'Door Passenger'
            :states:
              0: :closed
              1: :open
        :door_driver:
          :type: :switch
          :label: 'Door Driver'
          :states:
            0: :closed
            1: :open
      :index:
        :lamp_interior: 1
        :locked: 2
        :hood: 3
        :door_left: 4
        :door_right: 5
        :door_pass: 6
        :door_driver: 7
    :byte2:
      :type: :bit_array
      :parameters:
        :release:
          :type: :switch
          :label: 'Boot Release'
          :states:
            0: :off
            1: :on
        :hatch:
          :type: :switch
          :label: 'Hatch'
          :states:
            0: :closed
            1: :open
        :sunroof:
          :type: :switch
          :label: 'Sunroof'
          :states:
            0: :closed
            1: :open
        :window_left:
          :type: :switch
          :label: 'Window Rear Left'
          :states:
            0: :closed
            1: :open
        :window_right:
          :type: :switch
          :label: 'Window Rear Right'
          :states:
            0: :closed
            1: :open
        :window_pass:
            :type: :switch
            :label: 'Window Passenger'
            :states:
              0: :closed
              1: :open
        :window_driver:
          :type: :switch
          :label: 'Window Driver'
          :states:
            0: :closed
            1: :open
      :index:
        :release: 0
        :hatch: 2
        :sunroof: 3
        :window_left: 4
        :window_right: 5
        :window_pass: 6
        :window_driver: 7
  :index:
    :byte1: 0
    :byte2: 1
  :meta:
    :senders:
      - GM3
    :recipients:
      - GLO-L

# ************************************************************************* #
#                               RADIO
# ************************************************************************* #

0x34: # DSP-SET
  :properties:
    :short_name: DSP-SET
    :long_name: DSP EQ. Button
  :klass: Parameterized::Base
  :index:
    :mode: 0
    :adjustment: 1
  :parameters:
    :mode:
      :type: :map
      :dictionary:
        0x0f: On/Off

        0x10: Adjust

        0x28: Demo Off

        0x29: Concert Hall
        0x2a: Jazz Club
        0x2b: Cathedral
        0x2c: Memo 1
        0x2d: Memo 2
        0x2e: Memo 3

        0x90: Room

        0xff: 'Unsure?'
    :adjustment:
      :type: :bit_array
      :index:
        :frequency: !ruby/range
                  begin: 0
                  end: 2
                  excl: false
        :sign: 3
        :magnitude: !ruby/range
                  begin: 4
                  end: 7
                  excl: false
      :parameters:
        :frequency:
          :type: :map
          :label: 'Band'
          :dictionary:
            0b000: 80hz
            0b001: 200hz
            0b010: 500hz
            0b011: 1khz
            0b100: 2khz
            0b101: 5khz
            0b110: 12khz
        :sign:
          :type: :map
          :label: '¬±'
          :dictionary:
            0b0: '+'
            0b1: '-'
        :magnitude:
          :label: 'Magnitude'
          :type: :integer

0x35: # DSP-REP
  :properties:
    :short_name: DSP-REP
    :long_name: DSP Reply
  :klass: Parameterized::Base
  :index:
    :mode: 0
    :adjustment: 1
  :parameters:
    :mode:
      :type: :map
      :dictionary:
        0x0f: On/Off

        0x10: Adjust

        0x28: Demo Off

        0x29: Concert Hall
        0x2a: Jazz Club
        0x2b: Cathedral
        0x2c: Memo 1
        0x2d: Memo 2
        0x2e: Memo 3

        0x90: Room
    :adjustment:
      :type: :bit_array
      :index:
        :frequency: !ruby/range
                  begin: 0
                  end: 2
                  excl: false
        :sign: 3
        :magnitude: !ruby/range
                  begin: 4
                  end: 7
                  excl: false
      :parameters:
        :frequency:
          :type: :map
          :label: 'Band'
          :dictionary:
            0b000: 80hz
            0b001: 200hz
            0b010: 500hz
            0b011: 1khz
            0b100: 2khz
            0b101: 5khz
            0b110: 12khz
        :sign:
          :type: :map
          :label: '¬±'
          :dictionary:
            0b0: '+'
            0b1: '-'
        :magnitude:
          :label: 'Magnitude'
          :type: :integer

0x36: # RAD-EQ
  :properties:
    :short_name: RAD-EQ
    :long_name: Radio EQ Control
  :klass: Base
  # TODO: this should be a bit array
  :parameters:
    :setting:
      :type: :map
      :dictionary:
        0xa_f: dunno

        0x4_0: BALANCE -0
        0x4_1: BALANCE -1
        0x4_2: BALANCE -2
        0x4_3: BALANCE -3
        0x4_4: BALANCE -4
        0x4_5: BALANCE -5
        0x4_6: BALANCE -6
        0x4_7: BALANCE -7
        0x4_8: BALANCE -8
        0x4_9: BALANCE -9
        0x4_a: BALANCE -10
        0x4_b: BALANCE -11
        0x4_c: BALANCE -12
        0x4_d: BALANCE -13
        0x4_e: BALANCE -14
        0x4_f: BALANCE -15

        0x5_0: BALANCE +0
        0x5_1: BALANCE +1
        0x5_2: BALANCE +2
        0x5_3: BALANCE +3
        0x5_4: BALANCE +4
        0x5_5: BALANCE +5
        0x5_6: BALANCE +6
        0x5_7: BALANCE +7
        0x5_8: BALANCE +8
        0x5_9: BALANCE +9
        0x5_a: BALANCE +10
        0x5_b: BALANCE +11
        0x5_c: BALANCE +12
        0x5_d: BALANCE +13
        0x5_e: BALANCE +14
        0x5_f: BALANCE +15

        0x6_0: BASS -0
        0x6_2: BASS -1
        0x6_4: BASS -2
        0x6_6: BASS -3
        0x6_8: BASS -4
        0x6_a: BASS -5
        0x6_c: BASS -6

        0x7_0: BASS +0
        0x7_2: BASS +1
        0x7_4: BASS +2
        0x7_6: BASS +3
        0x7_8: BASS +4
        0x7_a: BASS +5
        0x7_c: BASS +6

        0x8_0: FADER -0
        0x8_1: FADER -1
        0x8_2: FADER -2
        0x8_3: FADER -3
        0x8_4: FADER -4
        0x8_5: FADER -5
        0x8_6: FADER -6
        0x8_7: FADER -7
        0x8_8: FADER -8
        0x8_9: FADER -9
        0x8_a: FADER -10
        0x8_b: FADER -11
        0x8_c: FADER -12
        0x8_d: FADER -13
        0x8_e: FADER -14
        0x8_f: FADER -15

        0x9_0: FADER +0
        0x9_1: FADER +1
        0x9_2: FADER +2
        0x9_3: FADER +3
        0x9_4: FADER +4
        0x9_5: FADER +5
        0x9_6: FADER +6
        0x9_7: FADER +7
        0x9_8: FADER +8
        0x9_9: FADER +9
        0x9_a: FADER +10
        0x9_b: FADER +11
        0x9_c: FADER +12
        0x9_d: FADER +13
        0x9_e: FADER +14
        0x9_f: FADER +15

        0xc_0: TREBLE +0
        0xc_2: TREBLE +1
        0xc_4: TREBLE +2
        0xc_6: TREBLE +3
        0xc_8: TREBLE +4
        0xc_a: TREBLE +5
        0xc_c: TREBLE +6

        0xd_0: TREBLE -0
        0xd_2: TREBLE -1
        0xd_4: TREBLE -2
        0xd_6: TREBLE -3
        0xd_8: TREBLE -4
        0xd_a: TREBLE -5
        0xd_c: TREBLE -6

0x37: # RAD-ALT
  :properties:
    :short_name: RAD-ALT
    :long_name: Radio Alternative Function
  # NOTE: defaulted to Base to due to Parameterized parsing issues
  :klass: Base
  :index:
    :mode: 0
  :parameters:
    :mode:
      :type: :map
      :dictionary:
        # SELECT C23
        0x4_0: (Select) A
          # [RADIO] [m] Manual Staion Choice
          # [TAPE] fast forward/reverse
        0x5_0: (Select) B
          # [RADIO] [SCAN] Radio Station Sample
          # [TAPE] music search
        0x6_0: (Select) C
          # [RADIO] [a] Automatic Search
        0x7_0: (Select) D
          # [CDC] [< >] Music Search

        # SELECT BM53
        0x0_4: (Select) A
          # [RADIO] [m]    Manual Staion Choice
          # [CDC]   [< >]  Music Search
        0x1_4: (Select) B
          # [RADIO] [SCAN]   Station sample
          # [CDC]   [RANDOM] Random generator
        0x2_4: (Select) C
          # [RADIO] [II]   Search sensitive
          # [CDC]   [SCAN] Track sample
        0x3_4: (Select) D
          # [RADIO] [I]     Search non sensitive
          # [CDC]   [<< >>] Fast forward/reverse

        # TONE C23
        0x8_0: (Tone) [?] Equalizer

        0x8_4: (Tone) [CDC] Equalizer
        0x8_6: (Tone) [RADIO] Equalizer
        0x9_0: (Tone) [RADIO] Equalizer

        0xc_0: (Tone) EQ. Bass
        0xd_0: (Tone) EQ. Treble
        0xe_0: (Tone) EQ. Fader
        0xf_0: (Tone) EQ. Balance

0x38: # CDC-REQ
  :properties:
    :short_name: CDC-REQ
    :long_name: CD Status Request
  :klass: Parameterized::CDChangerRequest
  :parameters:
    :control:
      :type: :map
      :dictionary:
        0x00: Status!
        0x01: Stop!
        0x02: Resume!?
        0x03: Play!
        0x04: Scan! (RWD/FFD)
        0x05: Seek! (Previous/Next)
        0x06: Change Disc!
        0x07: Scan Mode!
        0x08: Random Mode!
        0x0A: Change Track!
    :mode:
      :type: :integer
  :index:
    :control: 0
    :mode: 1

0x39: # CDC
  :properties:
    :short_name: CDC
    :long_name: CDC Status
  # NOTE: defaulted to Base to due to Parameterized parsing issues
  :klass: Base
  :index:
    :control: 0
    :status: 1
    :magazine: 2
    :loader: 3
    :b4: 4
    :cd: 5
    :track: 6
  :parameters:
    :control:
      :type: :map
      :dictionary:
        0x00: Stopped
        0x01: (BM53) Ready?
        0x02: Playing
        0x03: FFW
        0x04: RWD
        0x05: Next Track
        0x06: Previous Track
        0x07: Pending
        0x08: CDs Ready
        0x09: CD Check
        0x0a: Eject!
      :notes:
        - when CD play is first requested, CDC sends back 0x00
        - it's not until it responds with 0x02 that the audio is routed
    :status:
      :type: :map
      :label: Playing
      :dictionary:
        0x02: Stopped
        0x09: Playing
        0x82: (BM53) Stopped
        0x89: (BM53) Playing
        0x8c: (BM53) Ready?
    :magazine:
      :type: :map
      :dictionary:
        0x00: --
        0x08: Slot Empty!
    :loader:
      :type: :bit_array
      :parameters:
        :cd1:
          :type: :switch
          :label: CD6
          :states:
            0: :off
            1: :on
        :cd2:
          :type: :switch
          :label: CD5
          :states:
            0: :off
            1: :on
        :cd3:
          :type: :switch
          :label: CD4
          :states:
            0: :off
            1: :on
        :cd4:
          :type: :switch
          :label: CD3
          :states:
            0: :off
            1: :on
        :cd5:
          :type: :switch
          :label: CD2
          :states:
            0: :off
            1: :on
        :cd6:
          :type: :switch
          :label: CD1
          :states:
            0: :off
            1: :on
      :index:
        :cd1: 2
        :cd2: 3
        :cd3: 4
        :cd4: 5
        :cd5: 6
        :cd6: 7
    :b4:
      :type: :integer
    :cd:
      :type: :integer
    :track:
      :type: :integer

0x45: # UI-GFX
  :properties:
    :short_name: UI-CFG
    :long_name: Radio UI Config.
  :klass: Parameterized::Base
  :parameters:
    :config:
      :type: :bit_array
      :parameters:
        :unknown:
          :type: :switch
          :label: Split Screen?
          :states:
            0: :off
            1: :on
        :audio_obc:
          :type: :switch
          :label: Audio+OBC (BM23)
          :states:
            0: :off
            1: :on
        :info:
          :type: :switch
          :label: Split Coded?
          :states:
            0: :off
            1: :on
        :main_menu:
          :type: :switch
          :label: Main Menu
          :states:
            0: :off
            1: :on
      :index:
        :unknown: 0
        :info: 3
        :audio_obc: 6
        :main_menu: 7
  :index:
    :config: 0
  :meta:
    - the source of this is GFX module
    - seemingly to tell the radio when and what to render
    - used when audio disply is requested/falls back to
    - used when switching back from TV?

0x46: # UI-RAD
  :properties:
    :short_name: UI-RAD
    :long_name: Radio UI Requests
  :klass: Parameterized::Base
  :parameters:
    :state:
      :type: :bit_array
      :parameters:
        :hide_alt:
          :type: :switch
          :label: Hide Select?
          :states:
            0: :off
            1: :on
        :hide_eq:
          :type: :switch
          :label: Hide EQ?
          :states:
            0: :off
            1: :on
        :hide_panel:
          :type: :switch
          :label: Hide Panel (C23)
          :states:
            0: :off
            1: :on
        :main_menu:
          :type: :switch
          :label: Main Menu
          :states:
            0: :off
            1: :on
      :index:
        :hide_eq: 4
        :hide_alt: 5
        :hide_panel: 6
        :main_menu: 7
  :index:
    :state: 0
  :meta:
    - 01: confirm switch?

0x4A: # RAD-LED
  :properties:
    :short_name: RAD-LED
    :long_name: Radio LED
  :klass: Parameterized::RadioLED
  :parameters:
    :led:
      :type: :map
      # I think this is because tape is part of the BMBT? Like the CDC, it needs status updates to know if to play audio etc?
      :dictionary:
        0x00: "Off"

        0x40: Tape Eject
        0x41: Tape Play
        0x42: Tape FFF
        0x43: Tape RWW
        0x44: Tape FF
        0x45: Tape RW

        0x48: Radio

        0x5a: Tape 1
        0x5b: Tape 2
        0x5d: Tape Dolby B
        0x5e: Tape Dolby C
        0x5f: Tape Dolby OFF

        0x80: Unknown Mode

        0x90: "Off (Reset)"

        0xFF: "On"
  :index:
    :led: 0
  :meta:
    :senders:
      - RAD
    :recipients:
      - BMBT

0x4B: # SRC?
  # NOTE: defaulted to Base to due to Parameterized parsing issues
  :klass: Base
  :properties:
    :short_name: TAPE?
    :long_name: Audio Device Control
  :parameters:
    :control:
      :type: :map
      :dictionary:
        0x05: (16x9) Set Mode?
        0x06: (4x3) Set Mode?
    :mode:
      :type: :map
      :dictionary:
        0xE1: Unmute/Telephone Non-Priority (Handset)
        0xE2: Mute/Telephone Priority (Handsfree)

        0x30: Radio

        0x12: Tape / (1/A) ‚ñ∂Ô∏é
        0x11: Tape / (2/B) ‚ñ∂Ô∏é
        0x51: Tape / ‚ñ∑‚ñ∑
        0x42: Tape / ‚ñ∑‚ñ∑‚ñ∑
        0x61: Tape / ‚óÅ‚óÅ
        0x41: Tape / ‚óÅ‚óÅ‚óÅ

        0x81: Tape / Dolby Off
        0x82: Tape / Dolby C
        0x84: Tape / Dolby B

        0xF0: ERROR!
  :index:
    :control: 0
    :mode: 1

0x4E: # SRC-SND
  :properties:
    :short_name: SRC-SND
    :long_name: Select external audio input for tv?
  :klass: Parameterized::Base
  :index:
    :source: 0
    :b2: 1
  :parameters:
    :source:
      :type: :map
      :dictionary:
        0b0000_0000: Radio
        0b0000_0001: TV
    :b2:
      :type: :integer
  :meta:
    - 01 00: select TV
    - 00 00: go back to radio
    - 1500 messages to date 24 December 2018
    - from 0x3B GFX (exclusive)
    - to 0x68 RAD (exclusive)
    - argument 1 0x00 or 0x01
    - argument 2 always 0x00
    - 00 = 1496
    - 01 = 19

0x4F: # SRC-GFX
  # NOTE: defaulted to Base to due to Parameterized parsing issues
  :klass: Base
  :properties:
    :short_name: SRC-GFX
    :long_name: Display Output
  :parameters:
    :action:
      :type: :map
      :map:
        0x00: DISPLAY_OFF
        0x10: DISPLAY_ON
        0x01: TV
        0x02: MENU
      :dictionary:
        # Sent to BMBT
        0x00: BMBT Display Off
        0x10: BMBT Display On
        # Sent to NAV-JP
        0x01: TV On- disable nav?
        0x02: TV off- resume nav?
    :nav:
      :type: :map
      :map:
        0x00: nav
      :dictionary:
        0x00: unknown
  :index:
    :action: 0
    :nav: 1
  :meta:
    :senders:
      - GFX (0x3B)
    :recipients:
      :nav_jp:
        - 01    (TV ON)
        - 02 00 (TV OFF)
      :bmbt:
        - 00 (Monitor Off)
        - 10 (Monitor On)

# ************************************************************************* #
#                               BUTTONS
# ************************************************************************* #

0x3B: # MFL-RAD* / MFL-TEL*
  :schemas:
    - :tel
    - :rad
  :properties:
    :short_name: MFL-FUNC
    :long_name: Multifunction Steering Wheel (Controls)
  :klass: Parameterized::Button::MFL
  :index:
    :action: 0
  :parameters:
    :action:
      :type: :bit_array
      :index: &mfl_action_index
        :button_tel:    0
        :mode_tel:      1
        :state: !ruby/range
                        begin: 2
                        end: 3
                        excl: false
        :button_seek: !ruby/range
                      begin: 4
                      end: 7
                      excl: false
      :parameters:
        :button_tel:  &mfl_action_param_button_tel
          :type: :map
          :dictionary:
            0b0: '-'
            0b1: "[Tel]"
          :map:
            0b0: :mfl_tel_null
            0b1: :mfl_tel
        :mode_tel:    &mfl_action_param_mode_tel
          :type: :map
          :dictionary:
            0x0: '[R/T] Radio'
            0b1: '[R/T] Telephone'
          :map:
            0b0: :mfl_rt_rad
            0b1: :mfl_rt_tel
        :state:       *button_state
        :button_seek:
          :type: :map
          :dictionary:
            0b0000: '-'
            0b0001: "[Next]"
            0b1000: "[Prev]"
          :map:
            0b0000: :mfl_seek_null
            0b0001: :mfl_next
            0b1000: :mfl_prev
  :tel:
    :properties:
      :short_name: MFL-TEL*
      :long_name: Multifunction Steering Wheel Telephone Controls
    :klass: Parameterized::Button::MFL
    :index:
      :action: 0
    :parameters:
      :action:
        :type: :bit_array
        :index: *mfl_action_index
        :parameters:
          :button_tel:  *mfl_action_param_button_tel
          :mode_tel:    *mfl_action_param_mode_tel
          :state:       *button_state
          :button_seek:
            :type: :map
            :dictionary:
              0b0000: '-'
              0b0001: "[Next]"
              0b1000: "[Prev]"
            :map:
              0b0000: :mfl_seek_null
              0b0001: :mfl_tel_next
              0b1000: :mfl_tel_prev
  :rad:
    :properties:
      :short_name: MFL-RAD*
      :long_name: Multifunction Steering Wheel Radio Controls
    :klass: Parameterized::Button::MFL
    :index:
      :action: 0
    :parameters:
      :action:
        :type: :bit_array
        :index: *mfl_action_index
        :parameters:
          :button_tel: *mfl_action_param_button_tel
          :mode_tel:   *mfl_action_param_mode_tel
          :state:      *button_state
          :button_seek:
            :type: :map
            :dictionary:
              0b0000: '-'
              0b0001: "[Next]"
              0b1000: "[Prev]"
            :map:
              0b0000: :mfl_seek_null
              0b0001: :mfl_rad_next
              0b1000: :mfl_rad_prev

0x32: # VOL-RAD* / VOL-TEL*
  :schemas:
    - :tel
    - :rad
  :properties:
    :short_name: VOL
    :long_name: Volume Control
  :klass: Base
  :index: &volume_index
      :rotation: 0
  :parameters:
    :rotation:
      :type: :bit_array
      :index: &volume_rotation_index
        :steps: !ruby/range
                      begin: 0
                      end: 3
                      excl: false
        :direction: 7
      :parameters:
        :direction:
          :type: :map
          :label: Volume
          :dictionary:
            0: Down
            1: Up
          :map:
            0: :vol_down
            1: :vol_up
        :steps:
          :type: :integer
  :tel:
    :properties:
      :short_name: VOL-TEL*
      :long_name: Telephone Volume Control
    :klass: Parameterized::Rotary
    :index: *volume_index
    :parameters:
      :rotation:
        :type: :bit_array
        :index: *volume_rotation_index
        :parameters:
          :direction:
            :type: :map
            :label: Volume
            :dictionary:
              0: Down
              1: Up
            :map:
              0: :vol_tel_down
              1: :vol_tel_up
          :steps:
            :type: :integer
  :rad:
    :properties:
      :short_name: VOL-RAD*
      :long_name: Radio Volume Control
    :klass: Parameterized::Rotary
    :index: *volume_index
    :parameters:
      :rotation:
        :type: :bit_array
        :index: *volume_rotation_index
        :parameters:
          :direction:
            :type: :map
            :label: Volume
            :dictionary:
              0: Down
              1: Up
            :map:
              0: :vol_rad_down
              1: :vol_rad_up
          :steps:
            :type: :integer

0x47: # BMBT-SOFT
  :properties:
    :short_name: BMBT-SOFT
    :long_name: BMBT 'Soft' Button
  :klass: Parameterized::Button::BMBT
  :index:
    :action: 1
  :parameters:
    :action:
      :type: :bit_array
      :index:
        :state: !ruby/range
                        begin: 0
                        end: 1
                        excl: false
        :id: !ruby/range
                      begin: 2
                      end: 7
                      excl: false
      :parameters:
        :id:
          :type: :map
          :label: 'ID'
          :dictionary:
            0x0_f: "[Select]"
            0x3_8: "[Info]"
        :state:
          :type: :switch
          :label: 'State'
          :states:
            0b00: :press
            0b01: :hold
            0b10: :release
          :dictionary:
            0b00: Press
            0b01: Hold
            0b10: Release
  :notes:
    - replaces TP and RDS buttons
    - also doubles up on SELECT
    - six messages in total since started logs
    - 3 of each
    - F0 05 FF 47 00 38 75
    - F0 05 FF 47 00 B8 F5

0x48: # BMBT-ALL / BMBT-RAD* / BMBT-TEL* / BMBT-GFX*
  :schemas:
    - :tel
    - :rad
    - :gfx
  :properties:
    :short_name: BMBT-ALL
    :long_name: BMBT Buttons
  :klass: Parameterized::Button::BMBT
  :index: &bmbt_index
    :action: 0
  :parameters:
    :action: &bmbt_action
      :type: :bit_array
      :index: &bmbt_action_index
        :state: !ruby/range
                        begin: 0
                        end: 1
                        excl: false
        :id: !ruby/range
                      begin: 2
                      end: 7
                      excl: false
      :parameters: &bmbt_action_params
        :id: &bmbt_action_id
          :type: :map
          :label: 'ID'
          :dictionary:
            0x14: "[Tape Side]"
            0x24: "[Tape Eject]"
            0x11: "[1]"
            0x01: "[2]"
            0x12: "[3]"
            0x02: "[4]"
            0x13: "[5]"
            0x03: "[6]"
            0x23: "[Mode Prev]"
            0x33: "[Mode Next]"
            0x21: "[AM]"
            0x31: "[FM]"
            0x22: "[B]"
            0x32: "[C]"
            0x10: "[Prev]"
            0x00: "[Next]"
            0x20: "[Select]"
            0x04: "[Tone]"
            0x30: "[Overlay]"
            0x06: "[Power]"
            0x32: '[TP]'
            0x22: '[RDS]'
            0x08: "[TEL]"
            0x07: "[Aux. Heat]"
            0x34: "[Menu]"
            0x05: "[Confirm]"
          :map:
            0x14: :bmbt_tape_side
            0x24: :bmbt_tape_eject
            0x11: :bmbt_preset_1
            0x01: :bmbt_preset_2
            0x12: :bmbt_preset_3
            0x02: :bmbt_preset_4
            0x13: :bmbt_preset_5
            0x03: :bmbt_preset_6
            0x23: :bmbt_mode_prev
            0x33: :bmbt_mode_next
            0x21: :bmbt_am
            0x31: :bmbt_fm
            0x22: :bmbt_dolby_b
            0x32: :bmbt_dolby_c
            0x10: :bmbt_prev
            0x00: :bmbt_next
            0x20: :bmbt_select
            0x04: :bmbt_tone
            0x30: :bmbt_overlay
            0x06: :bmbt_power
            0x32: :bmbt_tp
            0x22: :bmbt_rds
            0x08: :bmbt_tel
            0x07: :bmbt_aux_heat
            0x34: :bmbt_menu
            0x05: :bmbt_confirm
        :state: *button_state
  :tel:
    :properties:
      :short_name: BMBT-TEL*
      :long_name: BMBT Buttons
    :klass: Parameterized::Button::BMBT
    :index: *bmbt_index
    :parameters:
      :action: *bmbt_action
  :rad:
    :properties:
      :short_name: BMBT-RAD*
      :long_name: BMBT Buttons
    :klass: Parameterized::Button::BMBT
    :index: *bmbt_index
    :parameters:
      :action: *bmbt_action
  :gfx:
    :properties:
      :short_name: BMBT-GFX*
      :long_name: BMBT Buttons
    :klass: Parameterized::Button::BMBT
    :index: *bmbt_index
    :parameters:
      :action: *bmbt_action

0x49: # BMBT-BTN-2 (BMBT-NAV)
  :properties:
    :short_name: BMBT-NAV
    :long_name: BMBT Navigation Rotary Button
  :klass: Parameterized::Rotary
  :index:
    :rotation: 0
  :parameters:
    :rotation:
      :type: :bit_array
      :index:
        :direction: 0
        :steps: !ruby/range
                      begin: 4
                      end: 7
                      excl: false
      :parameters:
        :direction:
          :type: :map
          :dictionary:
            0: Left
            1: Right
          :map:
            0: :bmbt_left
            1: :bmbt_right
        :steps:
          :type: :integer

0x57: # IKE-BTN
  :properties:
    :short_name: IKE-BTN
    :long_name: IKE Check Control
  :klass: Parameterized::Button::Base
  :index:
    :action: 0
  :parameters:
    :action:
      :type: :bit_array
      :index:
        :state: !ruby/range
                  begin: 1
                  end: 2
                  excl: false
        :id: !ruby/range
              begin: 3
              end: 7
              excl: false
      :parameters:
        :id:
          :type: :map
          :label: 'ID'
          :map:
            0x01: :check_control
            0x02: :bc_remote
          :dictionary:
            0b00001: Check Control
            0b00010: BC Remote
        :state:
          :type: :switch
          :label: 'State'
          :states:
            0b00: :press
            0b01: :hold
            0b10: :release
          :dictionary:
            0b00: Press
            0b01: Hold
            0b10: Release
  :meta:
    - only press and release

# ************************************************************************* #
#                             CLUSTER HUD
# ************************************************************************* #

# NOTE I'm not sure if this is exclusively CC warnings...
# Why does IKE forward a warning on?
0x1A: # CCM-ALRT
  :klass: Parameterized::Base
  :properties:
    :short_name: CCM-ALRT
    :long_name: CCM Cluster Warning
    :verbose: false
  :index:
    :mode: 0
    :control: 1
    :chars: !ruby/range
              begin: 2
              end: -1
              excl: false
  :parameters:
    :mode:
      :type: :map
      :map:
        0b0011_0000: :clear
        0b0011_0101: :request
        0b0011_0110: :persist
        0b0011_0111: :alert
        0b0011_1111: :unknown
      :dictionary:
        0b0011_0000: CCM Clear
        0b0011_0101: CCM Recall
        0b0011_0110: CCM Persist Indicators
        0b0011_0111: CCM Alert
        0b0011_1111: Unknown
    :control:
      :type: :bit_array
      :index:
        :gong: !ruby/range
                  begin: 3
                  end: 5
                  excl: false
        :chevron: !ruby/range
                    begin: 6
                    end: 7
                    excl: false
      :parameters:
        :gong:
          :type: :switch
          :label: 'Gong'
          :states:
            0b000: :off
            0b001: :single
            0b010: :tone
            0b011: :double
            0b100: :single
          :dictionary:
            0b000: 'Off'
            0b001: 'Single'
            0b010: 'Tone'
            0b011: 'Double'
            0b100: 'Single (Low)'
        :chevron:
          :type: :switch
          :label: 'Chevron'
          :states:
            0b0_0: :off
            0b0_1: :on
            0b1_1: :blink
          :dictionary:
            0b0_0: 'Off'
            0b0_1: 'On'
            0b1_1: 'Blink'
    :chars:
      :type: :chars
  :meta:
    :notes:
      priority_1:
        :desc:
          These defects are immediately indicated by a gong and a flashing
          warning symbol (1). Simultaneous defects will be displayed
          consecutively. These status reports remain in the display until the
          defects are corrected. It is not possible to delete them by pressing
          the CHECK button (3)
        :warnings:
          - RELEASE PARKINGBRAKE
          - COOLANT TEMPERATURE
          - STOP! ENGINE OILPRESS
          - CHECK BRAKE FLUID
          - FLAT TIRE
          - LOAD LEVEL INACTIVE
          - SPEED LIMIT
      :priority_2:
        :desc: These displays appear for 20 seconds when the ignition key is
          turned to position 2. The warning symbols remain after the message
          disappears. You can display the messages again by pressing the
          CHECK button (3)
        :warnings:
          - TRUNKLID OPEN
          - DOOR OPEN
          - FASTEN SEAT BELTS*
          - WASHER FLUID LOW
          - CHECK ENGINE OIL LEV
          - OUTSIDE TEMP. +207 (‚Äì56)
          - TIRE PRESSURE SET*
          - CHECK TIRE PRESSURE*
          - TIRE CHECK INACTIVE*
          - CHECK BRAKE LAMPS
          - CHECK LOWBEAM LAMPS
          - CHECK SIDE LAMPS
          - CHECK REAR LAMPS
          - CHECK FRONT FOGLAMPS
          - CHECK LICPLATE LAMP
          - CHECK HIGHBEAM LAMP
          - CHECK BACK UP LAMPS
          - TRANS. FAILSAFE PROG
          - CHECK BRAKE LININGS
          - CHECK COOLANT LEVEL
          - ENGINE FAILSAFE PROG
      :post_trip:
        :desc:
          All of the malfunctions registered during the trip appear consecutively
          when the key is turned to Position 0. Display appears when you open the
          driver's door after parking the vehicle. A supplementary gong is also heard.
          Status reports remain available for a pe- riod of approx. three minutes
          after the display goes out and the key is re- moved from the ignition. Press
          the CHECK button. If there were multiple reports, press the CHECK button
          repeatedly to view them all in sequence
        :warnings:
          - LIGHTS ON
          - KEY IN IGNITION LOCK
          - CHECK ENGINE OIL LEV

0x1B: # HUD-STATUS
  :properties:
    :short_name: HUD-STATUS
    :long_name: IKE Text Status?
  :klass: Parameterized::Base
  :parameters:
    :hud_status:
      :type: :map
      :dictionary:
        0x00: Set
        0x01: Busy
        0x02: Cleared
  :index:
    :hud_status: 0
  :schemas:
    - 0x3F
  0x3F:
    :id:
      :d: 27
    :properties:
      :short_name: DIA-PDC
      :long_name: Test PDC Sensors
    :klass: Base
  :meta:
    :examples:
      - TEL   	IKE   	23        40 20,
      - IKE   	TEL   	1B        02,
      - CCM   	IKE   	1A        35 00 20 20 43 48 45 43 4B 20 43 4F 4E 54 52 4F 4C 20 4F 4B 20 20,
      - IKE   	CCM   	1B        00,
      - CCM   	IKE   	1A        35 00 20 20 43 48 45 43 4B 20 43 4F 4E 54 52 4F 4C 20 4F 4B 20 20,
      - IKE   	CCM   	1B        00,
      - CCM   	IKE   	1A        30 00,
      - IKE   	CCM   	1B        00,
      - CCM   	IKE   	1A        30 00 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20,
      - IKE   	CCM   	1B        00,
      - the IKE requests something from radio?
      - IKE   	RAD   	CCM-STATUS	02
      - RAD   	IKE   	TXT-MEDIA 	64 (Radio Set Station) | 32 (Set IKE) 	""
      - IKE   	RAD   	CCM-STATUS	02
    :recipients:
      0x30: CCM
      0x68: RAD
      0xC8: TEL

0x51: # CCM-END
  :klass: Base
  :properties:
    :short_name: CCM-END
    :long_name: Ignition off CCM update?
  :parameters:
    :status:
      :type: :map
      :map:
        0x00: NO_WARNINGS
      :dictionary:
        0x00: No Warnings
  :index:
    :status: 0
  :notes:
    - CCM to IKE (always)
    - IKE responds with 0x52

0x52: # CCM-RLY
  :properties:
    :short_name: CCM-RLY
    :long_name: IKE CCM Forward?
  :klass: Parameterized::Base
  :index:
    :layout: 0
    :options: 1
    :chars: !ruby/range
              begin: 2
              end: -1
              excl: false
  :parameters:
    :layout:
      :type: :map
      :dictionary:
        0b0001_0001: '[Range] Set'
        0b0001_0000: '[Range] Clear?'
        0b0010_0001: '[Prog] Set'
        0b0010_0000: '[Prog] Clear'
        0b0011_0001: '[Code] Set'
        0b0011_0011: '[Code] Clear?'
    :options:
      :type: :bit_array
      :index:
        :gong: !ruby/range
                  begin: 5
                  end: 7
                  excl: false
      :parameters:
        :gong:
          :type: :map
          :label: 'Gong'
          :map:
            0b000: :off
            0b001: :high_single
            0b010: :high_continuous
            0b011: :high_double
            0b100: :low_single
          :dictionary:
            0b000: 'None'
            0b001: '[High] Single'
            0b010: '[High] Continuous'
            0b011: '[High] Double'
            0b100: '[Low] Single'
    :chars:
      :type: :chars
  :meta:
    :notes:
      - IKE to CCM (always)
      - commands to date
      - "   RANGE  50 KM     "
      - "   RANGE  50 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  24 KM     "
      - "   RANGE  41 KM     "
      - "   RANGE  40 KM     "
      - "   RANGE  50 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "   RANGE  34 KM     "
      - "      CODE ----     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "
      - "   RANGE  47 KM     "

# ************************************************************************* #
#                               TELEPHONE
# ************************************************************************* #

0x20: # TEL-OPEN
  :properties:
    :short_name: TEL-OPEN
    :long_name: Unknown
  :klass: Base
  :meta:
    :examples:
      - from GFX 02 0C

# ************************************************************************* #
#                           CONFIG VIA BMBT/MID
# ************************************************************************* #

0x40: # CONF-VAR
  :properties:
    :short_name: CONF-VAR
    :long_name: Configuration variables.
  :klass: Parameterized::Base
  :parameters:
    :field:
      :type: :map
      :dictionary:
        # SETTINGS
        0x01: (Settings) Time
        0x02: (Settings) Date

        # ON-BOARD COMPUTER
        0x07: (OBC) Distance
        0x09: (OBC) Limit

        # CODE
        0x0D: (Code) Code

        # AUX. VENTILATION
        0x0F: (Aux.) Timer 1
        0x10: (Aux.) Timer 2
    :input:
      :type: :data
  :index:
    :field: 0
    :input: !ruby/range
              begin: 1
              end: -1
              excl: false

0x41: # CONF-BOOL
  :klass: Parameterized::Base
  :properties:
    :short_name: CONF-BOOL
    :long_name: Configuration discrete.
  :parameters:
    :field:
      :type: :map
      :dictionary:
        # SETTINGS
        0x01: (Settings) Time               # [Variable Request]
        0x02: (Settings) Date               # [Variable Request]
        0x0c: (Settings) Memo               # [On, Off]
        0x0d: (Settings) TBC Memo

        # ON-BOARD COMPUTER
        0x03: (OBC) Temperature             # [Variable Request]
        0x04: (OBC) Consump. 1              # [Recalculate]
        0x05: (OBC) Consump. 2              # [Recalculate]
        0x06: (OBC) Range                   # [Variable Request]
        0x07: (OBC) Distance                # [Variable Request]
        0x08: (OBC) Arrival                 # [Variable Request]
        0x09: (OBC) Limit                   # [On, Off]
        0x0a: (OBC) Avg. Speed              # [Recalculate]
        0x0e: (OBC) Timer                   # [On, Off]
        0x1a: (OBC) Timer (Lap)             # [Lap]
        0x1b: (OBC) TBC Aux/Heat?

        # AUX. HEAT/VENTILATION
        0x0f: (Aux.) Timer 1                # [On, Off]
        0x10: (Aux.) Timer 2                # [On, Off]

        0x11: (Aux.) Heat (Off)
        0x12: (Aux.) Heat (On)
        0x13: (Aux.) Vent (Off)
        0x14: (Aux.) Vent (On)

    :control:
      :type: :map
      :map:
        0x00: --
      :dictionary:
        0b0000_0001: Lap/Variable Request
        0b0000_0010: TBC
        0b0000_0100: 'On/Start'
        0b0000_1000: 'Off/Stop'

        0b0001_0000: Recalculate
        0b0010_0000: Set As Current Speed
        0b0100_0000: '?'
        0b1000_0000: '?'
  :index:
    :field: 0
    :control: 1

# ************************************************************************* #
#                                 CLIMATE?
# ************************************************************************* #

0x86: # IHKA-NAV-86
  :properties:
    :short_name: NAV-IHKA-86
    :long_name: Unknown
  :klass: Base
  :meta:
    :notes:
      - reply from IHKA to nav_eu
      - it's not addressed to global? very specific?

0x87: # NAV-IHKA-87
  :properties:
    :short_name: NAV-IHKA-87
    :long_name: Unknown
  :klass: Base
  :meta:
    :notes:
      - send by :nav_eu???? to IKHA

0x82: # IHKA-GLO-82
  :properties:
    :short_name: IHKA-82
    :long_name: Unknown
  :klass: Base

0x83: # IHKA-83
  :properties:
    :short_name: IHKA-83
    :long_name: Unknown
  :klass: Base
  :meta:
    :senders:
      - IHKA

# ************************************************************************* #
#                          DIAGNOSTICS/INPA
# ************************************************************************* #

0x00: # DIA-HELLO
  :properties:
    :short_name: DIA-HELLO
    :long_name: Module General Information (and Ping)
  :klass: Base
  :meta:
    :senders:
      - DIA
      - GM (0x00)
    :recipients:
      - GM3   (0x00): '?'
      - TEL	  (0xC8):	1
      - BMBT	(0xF0):	126
      - LCM	  (0xD0):	208
      - MFL	  (0x50):	25
      - GFX	  (0x3B):	82
      - TV	  (0xED):	121
      - 0xE0	(0xE0):	9
      - RAD	  (0x68):	272
      - PDC	  (0x60):	63
      - 0x9A	(0x9A):	3

0x03: # B-PING?
  :properties:
    :short_name: B-PING
    :long_name: BUS Status Request?
  :klass: Base

0x04: # B-PONG? / DIA-ERR-READ
  :properties:
    :short_name: DIA-ERR-READ
    :long_name: BUS Status Reponse?
  :klass: Base
  :meta:
  :notes:
    - send when reading error memory
    - :example:
      - DIA     RAD     B-PONG          01
      - RAD     DIA     DIA-D           00 00 40 00 80
      - this had no errors
      - see screenshot
    - if i hit F1/READ in this screen, the same is sent again
    - :example:
      - DIA     RAD     B-PONG          01
      - RAD     DIA     DIA-D           00 00 40 00 80
  :recipients:
    - GFX    	01
    - TV     	01
    - RAD    	01
    - RAD    	01

0x05: # DIA-ERR-DEL / LCD-SET*
  :properties:
    :short_name: DIA-ERR-DEL
    :long_name: Diagnostics Clear Error Memeory?
  :klass: Base
  :schemas:
    - :gfx
  :gfx:
    :klass: Base
    :properties:
      :short_name: LCD-SET
      :long_name: LCD Brightness
    :meta:
      - absence of third argument will have BMBT reply with current brightness
      - gfx   bmbt	05  40 01
      - bmbt  gfx	  06  7F
      - this is what causes the bar meter value to change

  :meta:
    - when radio clear error memory selected
    - :example:
      - DIA     RAD     DIA-ERR-DEL     --
      - RAD     DIA     DIA-D           --
    - another selection
    - example1:
      - DIA     RAD     DIA-ERR-DEL     --
      - RAD     DIA     DIA-D           --

0x06: # DIA-MEM-READ / LCD-REP*
  :properties:
    :short_name: DIA-MEM-READ
    :long_name: Diagnostics Read Memory
  :klass: Base
  :schemas:
    - :bmbt
  :bmbt:
    :klass: Base
    :properties:
      :short_name: LCD-REP
      :long_name: LCD Brightness
  :meta:
    - the read memory function in INPA?
    - used to populate BMBT service mode displays

0x07: # DIA-MEM-WRITE
  :properties:
    :short_name: DIA-MEM-WRITE
    :long_name: Diagnostics Write Memory
  :klass: Base
  :meta:
    - if above is correct, then presumably the write...

0x08: # DIA-COD-READ
  :properties:
    :short_name: DIA-COD-READ
    :long_name: Diagnostics READ Coding Data Universal
  :klass: Base

0x09: # DIA-COD-WRITE
  :properties:
    :short_name: DIA-COD-WRITE
    :long_name: Diagnostics WRITE Coding Data
  :klass: Base

0x0b: # DIA-STATUS
  :properties:
    :short_name: DIA-STATUS
    :long_name: Unknown
  :klass: Base
  :meta:
    :notes:
      - radio got an error after this
      - :example:
        - DIA     RAD     0B              --
        - RAD     DIA     DIA-D           30 00 30 30 30 30 30 30 00 00
      - when i proceeded, the field that popped up was STATUS ANTENNA DIVERSITY
      - another error and the next field was STATUS AUX ADAPTER

0x0C: # DIA-VEH-CTRL
  :properties:
    :short_name: DIA-VEH-CTRL
    :long_name: Vehicle Control
    :verbose: true
  :klass: Base
  # :parameters:
  #   :action:
  #     :type: :map
  #     :dictionary:
  #       0x07: Seek Up
  #       0x08: Seek Down
  #       0x09: Activate Audio Button?
  #       0x0B: Radio Off
  #       0x0C: Radio On
  # :index:
  #   :action: 0
  :meta:
    :notes:

0x30: # SLF-CHK
  :properties:
    :short_name: SLF-CHK
    :long_name: Unknown
  :klass: Base

0x3f: # SLS-DIG
  :properties:
    :short_name: SLS-DIG
    :long_name: Unknown
  :klass: Base

0x60: # EWS-ISN?
  :properties:
    :short_name: EWS-ISN?
    :long_name: Diagnostics?
  :klass: Base

0x63: # DIA-IDENT
  :properties:
    :short_name: DIA-IDENT?
    :long_name: Diagnostics?
  :klass: Base

0x65: # EWS-KEY
  :properties:
    :short_name: EWS-KEY
    :long_name: Diagnostics?
  :klass: Base

0x69: # EWS-COD?
  :properties:
    :short_name: EWS-COD?
    :long_name: Diagnostics?
  :klass: Base

0x6B: # EWS-INT
  :properties:
    :short_name: EWS-INT
    :long_name: EWS Internal State
  :klass: Base

0x9c: # SLS-TRAN
  :properties:
    :short_name: SLS-TRAN
    :long_name: Diagnostics Transport Mode?
  :klass: Base
  :parameters:
    :mode:
      :type: :switch
      :states:
        0x02: :on
        0x00: :off
  :index:
    :mode: 0
  :meta:
    - also send to LCM?
    - DIA	LCM	9C 00
    - DIA	LCM	9C 00

0x9F: # EWS-X?
  :properties:
    :short_name: EWS-X?
    :long_name: Unknown?
  :klass: Base

0xA0: # DIA-DATA
  :properties:
    :short_name: DIA-DATA
    :long_name: Diagnostics Data
  :klass: Base

# ************************************************************************* #
#                                  UNKNOWN
# ************************************************************************* #

0x33:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x42:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x43:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x44:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x58:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x61:
  :properties:
    :short_name: EHC-STAT?
    :long_name: Unknown
  :klass: Base

0x70:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base

0x7d:
  :properties:
    :short_name: GM3-?
    :long_name: Unknown
  :klass: Base

0xbf:
  :properties:
    :short_name: "???"
    :long_name: Unknown
  :klass: Base
  :meta:
    :senders:
      0xD0: LCM
    :recipients:
      0x04: Unknown!
    :notes:
      - i've only seen it sent from LCM and exclusively to 0x04 which I haven't identified
      - it looks to be binary data but a 20 character string is included in the message (a_message.overlay(20, 90))
      - +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|
        | 90  | 91  | 92  | 93  | 94  | 95  | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 |
        +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|
        | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG | ARG |
        +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|
        | 20  | 20  | 20  | 52  | 41  | 4E  | 47  | 45  | 20  | 20  | 32  | 37  | 20  | 4B  | 4D  | 20  | 20  | 20  | 20  | 20  |
        +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|
        | 32  | 32  | 32  | 82  | 65  | 78  | 71  | 69  | 32  | 32  | 50  | 55  | 32  | 75  | 77  | 32  | 32  | 32  | 32  | 32  |
        +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|
        |     |     |     |  R  |  A  |  N  |  G  |  E  |     |     |  2  |  7  |     |  K  |  M  |     |     |     |     |     |
        +-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----|

0xd4:
  :properties:
    :short_name: RDS?
    :long_name: Channel list?
  :klass: Base
